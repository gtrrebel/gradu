\chapter{Matrix monotone functions -- part 2}

\section{Characterization}

\subsection{Main theorem}

Let's come back to theorem \ref{heuristic_loewner}: with the $k$-tone language it rewrites to

\begin{lause}\label{main_theorem}
	$f \in P_{n}(a, b)$, if and only if $f N(q)$ is $(2 n - 1)$-tone for any $q \in \C_{n - 1}[x]$.
\end{lause}

Main goal of this chapter is to prove this theorem. Note that in contrast to theorem \ref{heuristic_loewner} theorem \ref{main_theorem} makes sense without any regularity assumptions. The new version also gives a resolution to the regularity issues related to its predecessor. Recall that $(2 n - 1)$-tone functions are $C^{2 n - 3}$ and their $(2 n - 3)$'th derivative is convex. As convex functions are twice differentiable almost everywhere (see for instance TODO), $f N(q)$ is $(2 n - 1)$ times differentiable almost everywhere. We won't need these regularity properties, however.

There are also many different ways to talk about the polynomial part.
\begin{lem}\label{polynomial_lemma}
	Let $h : \C \to \C$. Then the following are equivalent:
	\begin{enumerate}[(i)]
		\item $h$ is a non-negative polynomial on real line with  $\deg(h) \leq 2 n$.
		\item There exists $q \in \C_{n}[x]$ such that $h = N(q)$.
		\item There exists $q_{1}, q_{2} \in \R_{n}[x]$ such that $h = q_{1}^2 + q_{2}^2$.
	\end{enumerate}
\end{lem}
\begin{proof}
	$(i) \Rightarrow (ii)$: If $h$ is non-negative on real axis, it's roots all appear in pairs (of which there are at most $n$): either with strict complex conjugate pairs, of pairs of double real roots. We may take $q$ to be $\sqrt{a_{n}}\prod (z - z_{i})$ where $z_{i}$ range over representatives of all the pairs and $a_{n}$ is the leading coefficient of $h$.

	$(ii) \Rightarrow (iii)$: If $q$ has single conjugate pair $(z_{0}, \overline{z_{0}})$ of roots we have
	\begin{align*}
		(z - z_{0}) (z - \overline{z_{0}}) = z^2 - 2 \Re(z_{0}) + |z_{0}|^2 = (z - \Re(z_{0}))^2 + \Im(z_{0})^2,
	\end{align*}
	so we may take $q_{1} = \cdot - \Re(z_{0})$ and $q_{2} = \Im(z_{0})$. But if $ N(q) = q_{1}^2 + q_{2}^2$ and $ N(r) = r_{1}^2 + r_{2}^2$, then
	\begin{align*}
		N(q r) = N(q) N(r) = (q_{1} r_{1} + q_{2} r_{2})^2 + (q_{1} r_{2} - q_{2} r_{1})^2,
	\end{align*}
	so polynomial of higher order can be dealt with inductively.

	$(iii) \Rightarrow (i)$: This is clear.
\end{proof}

To prove \ref{main_theorem} we are going to verify that for any $f : (a, b) \to \R$, we have 
\begin{align*}
	f \in & P_{n}(a, b) \\
	&\Leftrightarrow \\
	[x_{0}, x_{1}, x_{2}, \ldots, x_{2 n - 1}]_{f N(q)} \geq 0 &\text{ for any $q \in \C_{n - 1}[x]$ and $a < x_{0} < \ldots < x_{2 n - 1} < b$}.
\end{align*}
Note that the proof of \ref{heuristic_loewner} can be interpreted as saying
\begin{align*}
	D f_{A}(H) \geq 0 &\text{ for any $A \in \H_{(a, b)}$ and $H \geq 0$ with $\rank(H) = 1$} \\
	&\Leftrightarrow \\
	[\lambda_{1}, \lambda_{1}, \ldots, \lambda_{n}, \lambda_{n}]_{f N(q)} \geq 0 &\text{ for any $q \in \C_{n - 1}[x]$ and $a < \lambda_{1} < \ldots < \lambda_{n} < b$}.
\end{align*}
The idea of the proof was to note that the quadratic form of the derivative rewrites to such divided difference, where $\lambda$'s are the eigenvalues of $A$.

To avoid regularity issues we simply do the same thing without limits.

\begin{maar}
	Let us call a triplet $(A, B, v) \in \H(V)^{2} \times V$ a \textbf{projection pair} if $B - A = v v^{*}$. Let us further say that a projection pair $(A, B, v)$ is \textbf{strict}, if $v$ is not orthogonal to any eigenvector of $A$. 
\end{maar}

\begin{lem}\label{main_lemma}
	If $a < \lambda_{0} < \lambda_{1} < \ldots < \lambda_{2 n - 1} < b$ and $q \in \C_{n - 1}[x]$, we may find a strict projection pair $(A, B, v)$ such that
	\begin{align*}
		\langle (f(B) - f(A)) w, w \rangle = [\lambda_{0}, \lambda_{1}, \lambda_{2}, \ldots, \lambda_{2 n - 1}]_{f N(q)}
	\end{align*}
	for any $f : (a, b) \to \R$.

	Conversely, if $(A, B, v)$ is a strict projection pair and $w \in V$, then there exists $a < \lambda_{0} < \lambda_{1} < \ldots < \lambda_{2 n - 1} < b$ and polynomial $q \in \C_{n - 1}[x]$, such that for any $f : (a, b) \to \R$ we have
	\begin{align*}
		\langle (f(B) - f(A)) w, w \rangle = [\lambda_{0}, \lambda_{1}, \lambda_{2}, \ldots, \lambda_{2 n - 1}]_{f N(q)}.
	\end{align*}
\end{lem}

Before trying to understand the lemma we use it to prove theorem \ref{main_theorem}.

\begin{proof}
	``$\Rightarrow$": t.f.i.f lemma \ref{main_lemma}.

	``$\Leftarrow$": Take any $a I < A \leq B < b I$. Write $B - A = \sum_{i = 1}^{n} c_{i} P_{v_{i}}$ for some $c_{i} \geq 0$. To prove that $f(B) - f(A) \geq 0$ we simply need to prove that $f(A + \sum_{i = 1}^{k} c_{i} P_{v_{i}}) - f(A + \sum_{i = 1}^{k - 1} c_{i} P_{v_{i}}) \geq 0$ for any $1 \leq k \leq n$. We may hence assume that $(A, B, v)$ projection pair.

	We may also assume that $(A, B, v)$ is strict. Indeed, if this is not the case, we can decompose $V = (v_{1}) \oplus V'$, where $v_{1}$ is an eigenvector of $A$ orthogonal to $v$, and factorize $A = \arestr{A}{(v_{1})} \oplus \arestr{A}{V'}$ and $B = \arestr{A}{(v_{1})} \oplus \arestr{B}{V'}$. But now $f(B) - f(A) \geq 0$, if and only if $f(\arestr{B}{V'}) - f(\arestr{A}{V'}) \geq 0$, which would follow if we could prove that $f \in P_{n - 1}(a, b)$. So we should just add the sentence ``We induct on $n$." as the first sentence of this proof.

	The strict case follows immediately from the lemma \ref{main_lemma}.
\end{proof}

\begin{kor}
	$P_{n}$ is a local property: if $a < c < b < d$ and $f : (a, d) \to \R$ such that $\restr{f}{(a, b)} \in P_{n}(a, b)$ and $\restr{f}{(c, d)} \in P_{n}(c, d)$, then $f \in P_{n}(a, d)$.
\end{kor}
\begin{proof}
	t.f.i.f Theorem \ref{main_theorem} and Proposition \ref{k_tone_local}.
\end{proof}

\subsection{Main lemma}

It remains to understand what is going on with lemma \ref{main_lemma}. The surprising part about it is the following fact about eigenvalues of real maps.

\begin{lem}\label{projection_eigenvalues}
	Let $(A, B, v)$ be a projection pair. Then
	\begin{align*}
		\lambda_{1}(B) \geq \lambda_{1}(A) \geq \lambda_{2}(B) \geq \lambda_{2}(A) \geq \ldots \geq \lambda_{n}(B) \geq \lambda_{n}(A).
	\end{align*}
	$(A, B, v)$ is strict if and only if all the inequalities are strict.

	Conversely, given any two interlacing sequences $b_{1} \geq a_{1} \geq b_{2} \geq a_{2} \geq \ldots \geq b_{n} \geq a_{n}$ there exists a projection pair $(A, B, v)$ with $\lambda_{i}(A) = a_{i}$ and $\lambda_{i}(B) = b_{i}$.
\end{lem}

This lemma is based on the following explicit relationship between characteristic polynomials of a projection pair.

\begin{lem}\label{projection_characteristic_polynomial}
	Let $(A, B, v)$ be a projection pair. Then
	\begin{align*}
		\det(B - z I) = \det(A - z I) \left(1 + \langle (A - z I)^{-1}v, v\rangle\right)
	\end{align*}
	and
	\begin{align*}
		\det(z I - B) (z I - B)^{-1} v = \det(z I - A) (z I - A)^{-1} v
	\end{align*}
\end{lem}
\begin{proof}
	Both of these identities should be understood as equalities between rational functions (to avoid problems at the spectra of $A$ and $B$).

	By the basic properties of the determinant we have
	\begin{align*}
		\det(B - z I) =& \det(A - z I) \\
		&+ \|v\|^2 \det(\arestr{(A - z I)}{(v)^{\perp}}) \\
		=& \det(A - z I) + \|v\|^2 \det(A - z I) \langle (A - zI)^{-1} v, v \rangle/\|v\|^2 \\
		=&  \det(A - z I) \left(1 + \langle (A - z I)^{-1}v, v\rangle\right),
	\end{align*}
	where the second equality follows from the Cramer rule.

	Multiplying both sides of the second claim from left by $z I - A$ simplifies to an equivalent claim
	\begin{align*}
	\det(z I - B) v = \det(z I - A) (1 + \langle (A - z I)^{-1} v, v \rangle) v,
	\end{align*}
	which is just the first identity (multiplied by $v$).
\end{proof}

\begin{proof}[Proof of lemma \ref{projection_eigenvalues}]
	Note that if $v$ is orthogonal to one of the eigenvectors of $A$, $P_{v}$ doesn't affect this eigenspace. Hence, as one easily checks, we may forget this eigenvector and restrict our attention to a smaller space. Similarly for the converse: if $a_{i} = b_{j}$ for some $1 \leq i, j \leq n$ we can forget $a_{i}$ and $b_{j}$, and solve the remaining problem on smaller space. Consequently, we may assume that the pair $(A, B, v)$ and the inequalities in the converse are strict.

	Let $(e_{i})_{i = 1}^{n}$ be the eigenbasis of $A$ and consider the rational function
	\begin{align*}
		z \mapsto 1 + \langle (A - z I)^{-1}v, v\rangle = 1 + \sum_{i = 1}^{n} \frac{|\langle v, e_{i} \rangle|^2}{\lambda_{i}(A) - z}.
	\end{align*}
	It has $n$ poles of negative residue so it has a root between any two poles. Also it tends to $1$ at infinity so it has a root on $(\lambda_{1}(A), \infty)$. It has hence $n$ distinct roots. All these roots are eigenvalues of $B$ by Lemma \ref{projection_characteristic_polynomial} so they are exactly the eigenvalues. This implies the first claim.

	For the converse, first take $A$ with the given eigenvalues. By Lemma \ref{projection_characteristic_polynomial} we now just want to choose $v$ in such a way that
	\begin{align*}
		\frac{p_{B}(z)}{p_{A}(z)} = 1 + \langle (A - z I)^{-1}v, v\rangle= 1 + \sum_{i = 1}^{n} \frac{|\langle v, e_{i} \rangle|^2}{a_{i} - z},
	\end{align*}
	But this is clearly achieveable if can show that the residues of $p_{B}(z)/p_{A}(z)$ are negative, which follows easily from the interlacing property. Hence the converse.
\end{proof}

Let us then complete the proof of theorem \ref{main_theorem} by proving the lemma \ref{main_lemma}.

\begin{proof}[Proof of lemma \ref{main_lemma}]
	Assume first that $f$ is entire and fix a strict projection pair $(A, B, v)$ and $w \in V$. Similarly to the ``proof" of \ref{heuristic_main} we have
	\begin{align*}
		&\langle (f(B) - f(A)) w, w \rangle \\
		&= \frac{1}{2 \pi i}\int_{\gamma} \langle (z I - B)^{-1} v, w \rangle  \langle (z I - A)^{-1} w, v \rangle f(z) dz \\
		&= \frac{1}{2 \pi i}\int_{\gamma} \frac{\det(z I - A)}{\det(z I - B)}\langle (z I - A)^{-1} v, w \rangle  \langle (z I - A)^{-1} w, v \rangle f(z) dz \\
		&= \frac{1}{2 \pi i}\int_{\gamma} \frac{N(q)}{\det(z I - A) \det(z I - B)} f(z) dz \\
		&= [\lambda_{1}(A), \ldots, \lambda_{n}(A), \lambda_{1}(B), \ldots, \lambda_{n}(B)]_{f N(q)}. \\
	\end{align*}
	where Lemma \ref{projection_characteristic_polynomial} was used in the second equality and we write $q(z) = \det(z I - A) \langle (z I - A)^{-1} v, w \rangle$. By \ref{entire_interpolation} or by suitable formal interpretation one sees that this identity holds without any regularity assumptions.

	Now when $(A, B, v)$ ranges over all strict projection pairs, the permutations of tuples
	\begin{align}
	(\lambda_{1}(A), \ldots, \lambda_{n}(A), \lambda_{1}(B), \ldots, \lambda_{n}(B))
	\end{align}
	range over all tuples of $2 n$ distinct numbers on $(a, b)$. Hence to prove the lemma, we should verify that for fixed strict projection pair $(A, B, v)$, as $w$ ranges over $V$, $q$ ranges over $\C_{n - 1}[x]$. Note that the components of $\det(z I - A)(z I - A)^{-1} v$ with respect to an eigenbasis of $A$, $(e_{j})_{j = 1}^{n}$, are $p_{j}(z) =  \langle v, e_{j} \rangle \prod_{i \neq j}(z - \lambda_{i}(A))$. But since $p_{j}(\lambda_{i}(A)) \neq 0$, if and only if $i = j$, the components are linearly independent over $\C$ and hence span $\C_{n - 1}[x]$.
\end{proof}

	To recap, the map
	\begin{align*}
		V &\to \C_{n - 1}[x] \\
		w &\mapsto \det(z I - A) \langle (z I - A)^{-1} v, w \rangle = \sum_{j = 1}^{n} p_{j}(z) \langle e_{j}, w \rangle
	\end{align*}
	is antilinear bijection, the correspondence between $w$ and $q$.

\subsection{Dual pairing}

Proof of theorem \ref{main_theorem} is actually missing one more detail we need in the induction step.

\begin{lem}\label{k_tone_cor}
	If $f N(q)$ is $(2 n + 1)$-tone for $q \in \C_{n}[x]$, then $f N(\tilde{q})$ is $(2 n - 1)$-tone for every $\tilde{q} \in \C_{n - 1}[x]$.
\end{lem}

To understand this result, recall that for analytic $f$ and $a < x_{0} < x_{1} < \ldots < x_{2 n - 1} < b$ we have
\begin{align*}
	[x_{0}, x_{1}, \ldots, x_{2 n - 1}]_{f N(q)} = \frac{1}{2 \pi i} \int_{\gamma} \frac{N(q)}{(z - z_{0}) (z - z_{1}) \cdots (z - z_{2 n - 1})} f(z) dz,
\end{align*}
for suitable $\gamma$. One way to interpret this identity is to consider it as a linear map: for given analytic $f$ we have the map
\begin{align*}
	r \mapsto  \frac{1}{2 \pi i} \int_{\gamma} r(z) f(z) dz,
\end{align*}
where $r$ is a rational functions with its poles in the domain of $f$. Note that all this makes formally sense for arbitrary $f$ given that the poles of $r$ are simple. This motivates us to define a dual pairing $\langle \cdot, \cdot \rangle_{L}$ (over $\R$) between $\R^{(a, b)}$ and rational functions with simple poles on $(a, b)$, for which
\begin{align*}
	\langle f, r \rangle_{L} = \frac{1}{2 \pi i} \int_{\gamma} r(z) f(z) dz,
\end{align*}
for analytic $f$. We could of course replace $(a, b)$ by any subset of $\C$.

Now theorem \ref{main_theorem} is just saying that $f \in P_{n}(a, b)$, if and only if $\langle f, r \rangle_{L} \geq 0$ whenever $r$ is of the form
\begin{align*}
	r(z) = \frac{N(q)}{(z - z_{0}) (z - z_{1}) \cdots (z - z_{2 n - 1})}
\end{align*}
where $a < z_{0} < \ldots < z_{2 n - 1} < b$ and $q \in \C_{n - 1}[x]$. Let us denote this family of rational functions by $R_{n}(a, b)$. Now, in order to prove the lemma we should prove that we have
\begin{align*}
	\cone(R_{n}(a, b)) \subset \cone(R_{n + 1}(a, b))
\end{align*}

\begin{proof}[Proof lemma \ref{k_tone_cor}]
	Take any $r \in R_{n}(a, b)$. If there was no condition on the order of the poles, we could simply note that
	\begin{align*}
		r = r \frac{N(z - c)}{(z - c) (z - c)} \in R_{n + 1}(a, b).
	\end{align*}
	Even though that doesn't quite work, we can modify the idea a little: we have
	\begin{align*}
		r = \frac{1}{2} r \frac{N((z - c))}{(z - c) (z - \frac{c + d}{2})} +  \frac{1}{2} r \frac{N((z - d))}{(z - d) (z - \frac{c + d}{2})} \in \cone(R_{n + 1}(a, b))
	\end{align*}
	as soon as we choose $c, d \in (a, b)$ so that the poles remain simple.
\end{proof}

\section{Loewner's theorems}

Let's move our focus to the classes $P_{\infty}(a, b)$. Using the earlies ideas we can rewrite theorem \ref{heuristic_loewner} in the following form.

\begin{lause}\label{better_loewner}
	$f \in P_{\infty}(a, b)$, if and only if $f$ is analytic and for every $n \geq 1$ and $q \in \C_{n - 1}[x]$ the function $f N(q)$ is $(2 n - 1)$-tone.
\end{lause}

Without the analyticity condition this would immediately follow from \ref{main_theorem}, and the statement would also make perfect sense without it. It is nevertheless true that the functions in class $P_{\infty}(a, b)$ are analytic. One could use Bernstein type arguments and tricks (see proof of the theorem \ref{bernstein_theorem}) to convince oneself that this indeed the case, but there's actually a lot more going on.

First of all, the dual pairing thinking leads to much more satisfactory conclusion in the case $n = \infty$.

\begin{lem}
	We have
	\begin{align*}
		&R_{\infty}(a, b) := \bigcup_{n = 1}^{\infty} R_{n}(a, b) = \cone\left( \bigcup_{n = 1}^{\infty} R_{n}(a, b)\right) \\
		= &\{ \text{rational functions with only simple, real poles; non-negative} \\
		& \text{ on $\R \setminus (c, d)$ for some $a < c < d < b$; and decay $r(z) = O(|z|^{-2})$ at $\infty$} \}.
	\end{align*}
\end{lem}
\begin{proof}
	It is sufficient to prove that if $r$ is a rational function as in the lemma statement, then $r \in R_{n}(a, b)$ for some $n \geq 1$. So pick such $r$.

	Note that $r$ changes its sign even number of times, and only on interval $(a, b)$, say at points $a < x_{0} < x_{1} < \ldots < x_{2 n - 1} < b$. Write $p := \prod_{i = 0}^{2 n - 1} (\cdot - x_{i})$. Now $p r$ is a polynomial of degree less than $2 n$ non-negative on $\R$, so it is of the form $N(q)$ for some $q \in \C_{n - 1}[x]$. Hence we have
	\begin{align*}
		r = \frac{N(q)}{p} \in R_{n}(a, b).
	\end{align*}
\end{proof}

$R_{\infty}(a, b)$ is hence a predual cone of $P_{\infty}(a, b)$. Now, it might not be too big of a surprise that the class $R_{\infty}(a, b)$ is dense in $C_{c}(\R \setminus (a, b))$ (with uniform norm). This should imply, by the Riesz representation theorem, that for any $f \in P_{\infty}(a, b)$ there exists a Radon measure $\mu_{f}$ on $\R \setminus (a, b)$ with $\mu_{f}((\lambda^2 + 1)^{-1}) < \infty$ such that for any $r \in R_{\infty}(a, b)$
\begin{align*}
	\langle f, r \rangle_{L} = \int_{\R \setminus (a, b)} r(\lambda) d \mu_{f}(\lambda).
\end{align*}
This is almost true. As the functions $R_{\infty}(a, b)$ are not compactly supported, there's a problem at infinity.  Nevertheless, the previous holds with slight modification.

\begin{lause}[Loewner's theorem, version $1$]\label{integral_loewner}
	Let $f \in P_{\infty}(a, b)$. Then there exists a unique Radon measure $\mu_{f}$ on $\R \setminus (a, b)$ with $\mu_{f}((\lambda^2 + 1)^{-1}) < \infty$ and $\alpha \geq 0$ such that for any $r \in R_{\infty}(a, b)$ we have
	\begin{align*}
		\langle f, r \rangle_{L} = \alpha \left(\lim_{\lambda \to \infty} r(\lambda) \lambda^2 \right) + \int_{\R \setminus (a, b)} r(\lambda) d \mu_{f}(\lambda).
	\end{align*}
	In particular for any $x,y \in (a, b)$ we have
	\begin{align*}
		[x, y]_{f} = \alpha + \int_{\R \setminus (a, b)} \frac{d \mu_{f}(\lambda)}{(\lambda - x) (\lambda - y)}.
	\end{align*}
\end{lause}

Note that the limit $\left(\lim_{\lambda \to \infty} r(\lambda) \lambda^2 \right)$ exists and is non-negative for any $r \in R_{\infty}(a, b)$. It is clear that the converse of this theorem also holds. Note also that examples \ref{finite_pick} fit in the this framework: they correspond to positive linear combinations of $\delta$-measures. Theorem \ref{integral_loewner} can be interpreted as saying that all functions in the class $P_{\infty}(a, b)$ are more or less of the form \ref{finite_pick}; only summation is replaced with integration with respect to (somewhat) arbitrary measure.

Although it would not be terribly tricky to fill in the details to the previous argument, we will not prove \ref{integral_loewner}. Instead we look into one of its corollaries:

\begin{kor}
	Every $f \in P_{\infty}(a, b)$ has an analytic extension $\tilde{f}$ on $\C \setminus \R$. This extension maps (open) upper half-plane $\Hp$ to closed upper half-plane $\overline{\Hp}$.
\end{kor}

In fact, also this corollary has a converse.

\begin{lause}[Loewner's theorem, version $2$]\label{weak_loewner}
	Let $f : (a, b) \to \R$. Then $f \in P_{\infty}(a, b)$, if and only there exists a analytic function $\tilde{f}$ on $(\C \setminus \R) \cup (a, b)$ such that $\restr{\tilde{f}}{(a, b)} = f$ and $\tilde{f}$ maps the upper half-plane to its closure.
\end{lause}

This is the version of the Loewner's theorem we are going to focus on.

\section{Notes and references}

This chapter is largely original (?), although heavily inspired by multiple sources. Key ideas are an extension to \cite{Heina}. \ref{main_theorem} is new formulation of \ref{heuristic_main}. Lemma \ref{projection_eigenvalues} (or some variant of it) is present in many discussions of the matrix monotonicity, see for instance \cite{Don}. While \ref{main_lemma} is new (?) it can be seen as a variant of lemma $1$ in \cite{Sparr}. Theorem \ref{weak_loewner} appears in the original paper of Loewner \cite{Low}. \ref{integral_loewner} was first discussed in \cite{Ben}. Sparr in \cite{Sparr} gives proof of \ref{integral_loewner} somewhat similar in nature to our argument sketch (...). Bernstein type arguments for the analyticity are discussed in \cite{Ben}.
