\chapter{Pick-Nevanlinna functions}

\textit{Pick-Nevanlinna function} is an analytic function defined in upper half-plane with a non-negative imaginary part. Such functions are sometimes also called Herglotz or $\R$ functions; we will call them just \textit{Pick functions}. The class of Pick functions is denoted by $\pickclass$.

\section{Examples and basic properties}

Most obvious examples of Pick functions might be functions of the form $\alpha z + \beta$ where $\alpha, \beta \in \R$ and $\alpha \geq 0$. Of course one could also take $\beta \in \Hpc$. Actually real constants are the only Pick functions failing to map $\Hp \to \Hp$: non-constant analytic functions are open mappings.

Sum of two Pick functions is a Pick function and one can multiply a Pick function by non-negative constant to get a new Pick function. Same is true for composition.

The map $z \mapsto -\frac{1}{z}$ is evidently a Pick function. Hence are also all functions of the form
\[
	\alpha z + \beta + \sum_{i = 1}^{N} \frac{m_{i}}{\lambda_{i}- z},
\]
where $N$ is non-negative integer, $\alpha, m_{1}, m_{2}, \ldots, m_{N} \geq 0$, $\beta \in \Hp$ and $\lambda_{1}, \ldots, \lambda_{N} \in \Hp$. So far we have constructed our function by adding simple poles to the closure of lower half-plane. We could further add poles of higher order at lower half plane, and change residues and so on, but then we have to be a bit more careful.

There are (luckily) more interesting examples: all the functions of the form $x^{p}$ where $0 < p < 1$ are Pick functions. To be precise, one should choose branch for the previous so that they are real at positive real axis. Also $\log$ yields Pick function when branch is chosen properly i.e. naturally again. Another classic example is $\tan$. Indeed, by the addition formula
\begin{eqnarray*}
	\tan(x + i y) &=& \frac{\tan(x) + \tan(i y)}{1 - \tan(x) \tan(i y)} = \frac{\tan(x) + i \tanh(y)}{1 - i \tan(x) \tanh(y)} \\
	&=& \frac{\tan(x)(1 + \tanh^2(y))}{1 + \tan^2(x) \tanh^2(y)} + i \frac{(1 + \tan^2(x))\tanh(y)}{1 + \tan^2(x) \tanh^2(y)},
\end{eqnarray*}
and $y$ and $\tanh(y)$ have the same sign.

As one might have guessed by now, Pick functions are our set of ``positive analytic functions".

\begin{lause}
	$\pickclass \subset \{\text{analytic maps on $\Hp$} \}$ is a proper cone.
\end{lause}
\begin{proof}
	Again, since the evaluation functionals are continuous, we are essentially left to check that the fourth condition, i.e. we should prove that
	\begin{align*}
		\Im(\varphi) = 0 \Leftrightarrow \varphi = 0.
	\end{align*}
	And again, this isn't quite true, even for analytic functions. Imaginary part being constant merely implies that function is a real constant. Good enough.
\end{proof}

Again, one could instead consider the quotient space, analytic maps up to a constant, and we would have a proper cone, but this kind of thinking isn't bringing much to the discussion.

So far we have made no mention on the topology, as it's usually taken to be the topology of locally uniform convergence. This definitely works (as it makes the evaluation functionals continuous), but we can do much better. It namely turns out that we can consider the set of Pick functions as a proper cone of $\C^{\Hp}$, set of all functions, with product topology.

\begin{prop}\label{pick_convergence}
	If $(\varphi_{i})_{i = 1}^{\infty}$ is a sequence of Pick functions converging pointwise, the limit function is also a Pick function.
\end{prop}

This result far from clear: pointwise limits of analytic functions need not in general be analytic. We will not prove the result yet, but it strongly suggests that there is something more going on; Pick functions are very rigid. Note also that if Pick functions are thought of a subset of all functions, the definition of the cone doesn't really fit the general framework of theorem \ref{positive_machine}. This suggests that we are missing some better functionals.

\section{The Goal}

\section{Rigidity}

\subsection{Boundary}

To understand the rigidity phenomena we take look at a close relative to Pick functions, \textit{Schur functions}. Schur funtions are analytic maps from open unit disc to closed unit disc. Classic fact about these functions is the Schwarz lemma.

\begin{lause}[Schwarz lemma]
	Let $\psi : \D \to \D$ be analytic such that $\psi(0) = 0$. Then $|\psi(z)| \leq |z|$ for any $z \in \D$ and hence also $|\psi'(0)| \leq 1$. If $|\psi(z)| = |z|$ for some $z \in \D \setminus \{0\}$ or $|\psi'(0)| = 1$, $\psi(z) = \omega z$ for some $\omega \in \mathbb{S}$.
\end{lause}

The textbook proof is based on two observations about analytic functions.
\begin{itemize}
	\item If $\varphi$ is analytic at $a$ with $\varphi(a) = 0$, then $\varphi/(\cdot - a)$ is also analytic.
	\item If $\varphi$ is analytic on closed unit disc and $|\varphi| \leq 1$ on the boundary of the disc, then $|\varphi| \leq 1$ inside the disc.
\end{itemize}

The first observation might not be very surprising, and it holds for smooth functions also. The second, on the other hand, is a true manifestation of the nature of the analytic maps: we can bound analytic functions simply by bounding them on the boundary of the domain. More generally, one knows everything about an analytic function on a domain simply by knowing it on a boundary, by Cauchy's integral formula.

This tells us that we should be able to recognize also Pick functions looking only at their boundary values. Actually even more is true: it suffices to look at the imaginary parts.

\begin{prop}
	Let $\varphi : U \to \C$ be analytic, such that $\overline{\Hp} \subset U$, and $\varphi$ is continuous at $\infty$. Then if the imaginary part of $\varphi$ is non-negative on the real axis, $\varphi$ is Pick function.
\end{prop}
\begin{proof}
	This follows immediately from the minimum principle applied to the harmonic function $\Im(\varphi)$.
\end{proof}

\subsection{Integral representations}

Recall that imaginary part of an analytic function determines also its real part, up to a constant, so we can also recover the function itself. This can be also done explicitely.

\begin{lause}
	Let $\varphi : U \to \C$ be analytic, such that $\overline{\Hp} \subset U$, and $\varphi(z) = O(|z|^{-\varepsilon})$ for some $\varepsilon > 0$ at infinity. Then for any $z \in \Hp$ we have
	\begin{align*}
		\varphi(z) = \frac{1}{\pi}\int_{\R} \frac{\Im(\varphi)(\lambda)}{\lambda - z} d \lambda
	\end{align*}
\end{lause}
\begin{proof}
	Note that the integral defines an analytic function, imaginary part of which equals
	\begin{align*}
		\frac{\Im(z)}{\pi}\int_{\R} \frac{\Im(\varphi)(\lambda)}{(\lambda - z)(\lambda - \overline{z})} d \lambda.
	\end{align*}
	This expression however equals $\Im(\varphi(z))$ by Poisson integral formula. By letting $z \to \infty$ one sees that also the real constants match.

	Alternatively one could observe that for a closed counter clockwise oriented curves $\gamma $on the upper half-plane, enclosing $z$, we have
	\begin{align*}
		\varphi(z) = \frac{1}{2\pi i}\int_{\gamma} \frac{\varphi(\lambda)}{\lambda - z} d \lambda.
	\end{align*}
	Now given the bound, we may deform the contour to real axis. By comparing this identity and our goal, we are left to prove that
	\begin{align*}
		\frac{1}{2\pi i}\int_{\gamma} \frac{\overline{\varphi(\lambda)}}{\lambda - z} d \lambda = \frac{1}{2\pi i} \overline{\int_{\gamma} \frac{\varphi(\lambda)}{\lambda - \overline{z}} d \lambda}.
	\end{align*}
	But this is clear as $\varphi/(\cdot - \overline{z})$ is analytic in the upper half-plane.
\end{proof}

Compare this with theorem \ref{basis_k-tone}: in both cases we can express a (regular enough) positive element ($k$-tone functions and Pick functions) as a linear combination of some kind of basis elements.

There's of course nothing really special about the decay assumption $\varphi(z) = O(|z|^{-\varepsilon})$; it's there just to make everything converge.

One can guarantee the convergence also by other means. Note that the integrand behaves like $\frac{1}{\lambda - z}$, if we subtract something from it something behaving the same way at the infinity (something not depending on $z$), we ought to improve convergence, but only change the value of the function by a constant. As an example, consider the integral
\begin{align*}
	\frac{1}{\pi}\int_{\R} \left(\frac{1}{\lambda - z} - \frac{[|\lambda| > 1]}{\lambda} \right) \Im(\varphi)(\lambda)d \lambda.
\end{align*}
It converges as long as, say, $ \Im(\varphi)$ is bounded to an analytic function. As before, its imaginary part coincides with $\varphi$'s so the functions equal up to a real constant. Now it's not clear however that the functions should equal and indeed they need not: the right-hand side doesn't see real constants.

Note that the previous idea could be used to construct Pick functions. Everything still makes sense if we replace $\Im(\varphi)$ by some other positive function, as long as the integral converges. Heck, we could replace it by any positive measure for which $\mu((\lambda^2 + 1)^{-1}) < \infty$.

(Almost) all the examples given before are actually just special cases of this construction. The rational functions $\frac{1}{\lambda - z}$, where $\lambda \in \R$ are obtained by setting $\mu = \delta_{\lambda}$. The power functions are obtained as
\begin{align*}
	z^{p} &= c_{0} + \frac{1}{\pi}\int_{-\infty}^{0} \left(\frac{1}{\lambda - z} - \frac{1}{\lambda - 1}\right) \Im(\lambda^{p}) d \lambda \\
	&= c_{0} + \frac{1}{\pi}\int_{-\infty}^{0} \left(\frac{1}{\lambda - z} - \frac{1}{\lambda - 1}\right) |\lambda|^{p} \sin(\pi p) d \lambda,
\end{align*}
for some constant $c_{0}$ (which can be seen to be $1$ by setting $z = 1$). Logarithm is even simpler:
\begin{align*}
	\log(z) = \int_{-\infty}^{0} \left(\frac{1}{\lambda - z} - \frac{1}{\lambda - 1}\right) d \lambda.
\end{align*}
Tangent function could be obtained by putting $\delta$-measures to the points of the form $\frac{\pi}{2} + n \pi$, where $n \in \Z$, the singularities of tangent.

The only exception is the function $z \mapsto \alpha z$ -- it can't be expressed as such integral. But even this failure is really more about poor point of view, as we will see in a minute. With these observations in mind it ought to be not too surprising that we have the following.

\begin{lause}\label{pick_nevanlinna_herglotz_representation_theorem}
	$\varphi \in \pickclass$, if and only
	\begin{align}\label{pick_representation}
		\varphi(z) = \alpha z + \beta + \int_{-\infty}^{\infty} \left(\frac{1}{\lambda - z} - \frac{\lambda}{\lambda^2 + 1}\right) d \mu(\lambda)
	\end{align}
	for some $\alpha \geq 0$ and $\beta \in \R$ and a Borel measure $\mu$ with $\int_{-\infty}^{\infty} (\lambda^2 + 1)^{-1} d \mu(\lambda) < \infty$.
\end{lause}

Choosing $\lambda \mapsto \frac{\lambda}{\lambda^2 + 1}$ is common choice in the literature and is convenient as
\begin{itemize}
	\item It's real. This is really not too big of a deal though, but it aids in keeping track with the real and imaginary parts.
	\item We may recover the constant $\beta$ as $\Re(\varphi(i))$.
\end{itemize}

To better explain the appearance of the linear term, we can write the integral in a sligtly different form. Denoting $d \nu(\lambda) = \frac{d \mu(\lambda)}{\lambda^2 + 1}$, the formula reads
\begin{align*}
	\varphi(z) = \alpha z + \beta + \int_{-\infty}^{\infty} \frac{\lambda z + 1}{\lambda - z} d \nu(\lambda).
\end{align*}
Here $\nu$ is just a finite Borel measure. Now it kind of makes sense to extend the domain of this measure to infinity: the linear term merely corresponds to $\delta$-measure at infinity point. Of course, should one formalize this line of thought, the question on the type of extended real line had to be asked and one should address the topology. The answer is that one should glue the real line into a circle. One shouldn't worry about such issues, though, as these thoughts are here merely for intuition, at least for know. The giveaway is that $\alpha$ should be really thought as a part of the measure $\mu$, even though this might not make perfect sense.

We will not prove theorem \ref{pick_nevanlinna_herglotz_representation_theorem} results yet, but it shall work as a motivation. In order to understand Pick functions, we should understand their boundaries.

\subsection{Pick functionals}

\begin{quest}
	How can we recover the measure $\mu$ from the Pick function?
\end{quest}

If $\mu$ is given by a continuous, bounded function, i.e. $d \mu(\lambda) = f(\lambda) d \lambda$, it's not very hard to see that
\begin{align*}
	f(\lambda) = \frac{1}{\pi}\lim_{y \to 0^{+}} \Im(\varphi(\lambda + i y)).
\end{align*}

This doesn't however work with rational functions with poles on the real line. One might try to salvage the situation by saying that poles should correspond to $\delta$-measures, but even if that would be true in some sense, we are only scratching the surface. What to do if the measure is for instance the uniform measure on the Cantor set?

Beauty of the measure theory is of course that we don't even need to make sense of the measure pointwise; everything is hidden in the averages. Could we recover the measures of open intervals then? Is it true that
\begin{align*}
	\mu((a, b)) = \lim_{y \to 0^{+}}\frac{1}{\pi}\int_{a}^{b} \Im(\varphi(\lambda + i y)) d \lambda?
\end{align*}
Even this isn't quite true: the problem is that if $\mu$ contains $\delta$-measure at $a$ or at $b$, the right-hand side doesn't see this properly. It turns out that this is only problem though.

We have however already encountered much better averages: the imaginary part of a Pick function $\varphi$ is a weighted average of the imaginary parts of $\varphi$ on the real line. We only proved this in the case of bounded $\varphi$, and indeed, the proper generalization should be 
\begin{align*}
	\Im(\varphi(z)) = \alpha \Im(z) + \frac{\Im(z)}{\pi}\int_{\R} \frac{d \mu(\lambda)}{(\lambda - z)(\lambda - \overline{z})}.
\end{align*}
Bear in mind that we also consider the constant $\alpha$ be part of the measure. One can take this idea much further: if $q$ is any rational function with simple poles, no poles on $\R$, and decay $O(|z|^{-2})$ at infinity, the expression
\begin{align*}
	\int_{\R} q(\lambda) d \mu(\lambda)
\end{align*}
makes sense. Even better, partial fraction expansion allows us to write this integral in terms of as a linear combination of values of $\varphi$ and its conjugate. Indeed, partial fraction decomposition allows us to write $q$ as
\begin{align*}
	q(\lambda) = c_{0}\frac{\lambda}{\lambda^2 + 1} + \sum_{i = 1}^{M} c_{i} \left(\frac{1}{\lambda - a_{i}} - \frac{\lambda}{\lambda^2 + 1}\right),
\end{align*}
where $a_{i}$'s are the poles of $q$. The decay condition tells that $c_{0} = 0$. If $\Im(a_{i}) > 0$, term corresponds to multiple of $\varphi(a_{i})$, and if $\Im(a_{i}) < 0$, we get the conjugate. Explicitly, if we abuse notation a tad by writing $\varphi(a_{i}) = \overline{\varphi(\overline{a_{i}})}$ if $\Im(a_{i}) < 0$, we have
\begin{align*}
	\int_{\R} q(\lambda) d \mu(\lambda) &= \int_{\R} \sum_{i = 1}^{M} c_{i} \left(\frac{1}{\lambda - a_{i}} - \frac{\lambda}{\lambda^2 + 1}\right)\mu(\lambda) \\
	&= \sum_{i = 1}^{M} c_{i} \left(\varphi(a_{i}) - \alpha a_{i} - \beta\right),
\end{align*}
which rewrites to
\begin{align*}
	\sum_{i = 1}^{M} c_{i} \varphi(a_{i}) &= \sum_{i = 1}^{M} c_{i} \left(\alpha a_{i} + \beta\right) + \int_{\R} q(\lambda) d \mu(\lambda).
\end{align*}
We can get some kind of glimpse of the measure just by looking at linear combinations of the values of Pick function.

TODO






Maximum modulus principle itself is consequence of the Cauchy's integral formula. There's also more symmetric form for Schwarz lemma, called Schwarz-Pick theorem.

\begin{lause}[Schwarz-Pick theorem]
	Let $\psi : \D \to \D$ be analytic. Then for any $z_{1}, z_{2} \in \D$ we have
	\[
		\left|\frac{\psi(z_{1}) - \psi(z_{2})}{1 - \overline{\psi(z_{1})} \psi(z_{2})} \right| \leq \left|\frac{z_{1} - z_{2}}{1 - \overline{z_{1}}z_{2}}\right|,
	\]
	and
	\[
		\frac{\left|\psi'(z_{1})\right|}{1 - |\psi(z_{1})|^2} \leq \frac{1}{1 - |z_{1}|^2}.
	\]
	If the equality holds in one of the inequalities, $\psi$ is a Blaschke factor.
\end{lause}

Note that one obtains the usual Schwarz lemma if $z_{1} = 0 = \psi(z_{1})$. One may check that if $\psi$ is Blaschke factor, the inequalities hold as equalities.
\begin{proof}
	Consider the map $\psi_{1} = \rho_{\psi(z_{1})} \circ \psi \circ \rho_{z_{1}}$. The claim follows by using the previous form of the Schwarz lemma for the $\psi_{1}$ and point $z_{2}$.
\end{proof}

The previous result shows that Blaschke factors are exactly the analytic bijections $\D \to \D$.

One can also make weaker estimates straight from Cauchy's integral formula. We can for instance write
\[
	\psi(a) = \frac{1}{2 \pi i}\int_{\gamma} \frac{\psi(z)}{z - a} dz
\]
for suitable $\gamma$. Now if $\psi$ extends over unit circle, letting $\gamma$ trace unit circle we have
\[
	|\psi(a)| \leq \left(\max_{|z| = 1} \left|\psi(z)\right| \right) \frac{1}{2 \pi}\int_{0}^{2 \pi} \frac{d t}{|e^{i t}  - a|}.
\]
This is not very strong estimate; the averaged integral tends to infinity as $|a| \to 1$, but the point is that by a simple argument we have can some bound on analytic function on a disc given only bound on its boundary values.

The point in looking at Schur functions is that we can directly bring the claims for Schur functions to Pick functions with maps
\begin{align*}
	\toplane : \D \to \Hp & \hspace{1cm} \toplane (z) = i \frac{1 - z}{1 + z} \\
	\tocircle : \Hp \to \D & \hspace{1cm} \tocircle (z) = \frac{i - z}{i + z}.
\end{align*}
If $\psi$ is Schur function then $\toplane \circ \psi \circ \tocircle$ is a Pick function, and conversely every Pick function $\varphi$ gives rise to Schur function $\tocircle \circ \varphi \circ \toplane$. We can directly translate Schwarz-Pick theorem to Pick functions.

\begin{lause}[Schwarz-Pick theorem for the upper half-plane]
	Let $\varphi : \Hp \to \Hp$ be analytic. Then for any $z_{1}, z_{2} \in \Hp$ we have
	\[
		\left|\frac{\varphi(z_{1}) - \varphi(z_{2})}{\varphi(z_{1}) - \overline{\varphi(z_{2})}} \right| \leq \left|\frac{z_{1} - z_{2}}{z_{1} - \overline{z_{2}}} \right|.
	\]
\end{lause}

Correspondingly analytic bijections in $\pickclass$ are exactly function of the form
\[
	z \mapsto \frac{a z + b}{c z + d},
\]
where $a, b, c, d \in \R$ and $a d - b c > 0$. Among these mapping the map
\[
	f : z \mapsto \frac{z \Re(w_{0}) - (|w_{0}|^2 + \Im(w_{0}))}{(1 + \Im(w_{0})) z - \Re(w_{0}))}
\]
satisfies $f(i) = w_{0}$.

We denote
\begin{align*}
	\tilde{d}(z_{1}, z_{2}) = \left|\frac{z_{1} - z_{2}}{z_{1} - \overline{z_{2}}} \right|.
\end{align*}
Schwarz-Pick theorem tells us that $\tilde{d} \circ \varphi \leq \tilde{d}$ for any Pick functions $\varphi$. Consequently $\tilde{d} \circ \varphi = \tilde{d}$ if $\varphi$ is an bijection.

\subsection{Pick matrices}

We can also arrive at the previous estimate directly using Cauchy's integral theorem, a bit similarly as with unit disc. Assume first that $\varphi$ is a bounded Pick-function extending over real line. We can start by proving that if $\varphi$ has positive imaginary part on real line, then it has positive real part on whole upper half-plane The idea to consider
\begin{align*}
	\varphi(a) = \frac{1}{2 \pi i}\int_{\gamma} \frac{\varphi(z)}{z - a} dz,
\end{align*}
again for suitable closed curve $\gamma$. If $\varphi$ decays fast enough at infinitity, we can deform the contour $\gamma$ to coincide with real axis. The unfortunate thing is that the we can't say much about the real or imaginary part of $ \frac{\varphi(z)}{z - a}$. But there's a trick: we can fix our problem by considering
\begin{align*}
	\frac{1}{2 \pi i}\int_{-\infty}^{\infty} \frac{\varphi(z)}{(z - a) (z - \overline{a})} dz.
\end{align*}
This expression has positive real part, and by using the residue theorem, the real part equals
\[
	\frac{\varphi(a) - \overline{\varphi(a)}}{a - \overline{a}},
\]
hence the claim. Also, boundedness is enough for this computation.

To arrive at Schwarz-Pick theorem consider integral
\begin{align*}
	\frac{1}{2 \pi i}\int_{-\infty}^{\infty} \varphi(z) \left(\frac{c_{1}}{z - z_{1}} + \frac{c_{2}}{z - z_{2}} \right) \left(\frac{\overline{c_{1}}}{z - \overline{z_{1}}} + \frac{\overline{c_{2}}}{z - \overline{z_{2}}} \right) dz.
\end{align*}
Again, the point is that writing $h(z) = \frac{c_{1}}{z - z_{1}} + \frac{c_{2}}{z - z_{2}}$, $h$ is meromorphic in upper half-plane expect for the simple poles at $z_{1}$ and $z_{2}$, thus giving information about $\varphi(z_{1})$ and $\varphi(z_{2})$, $\overline{h(\overline{z})}$ is analytic in the upper halfplane and $h(z)\overline{h(\overline{z})}$ is real on the real axis.

Now this expression should have positive real part for any $c_{1}, c_{2} \in \C$, and computing the real part using the residue theorem, we arrive at
\begin{align*}
	[z_{1}, \overline{z_{1}}]_{\varphi} |c_{1}|^{2} &+ [z_{1}, \overline{z_{2}}]_{\varphi} c_{1} \overline{c_{2}} \\
	[z_{2}, \overline{z_{1}}]_{\varphi} c_{2} \overline{c_{1}} &+ [z_{2}, \overline{z_{2}}]_{\varphi} |c_{2}|^{2},
\end{align*}
where we abuse the notation a little by writing $\varphi(\overline{z}) = \overline{\varphi(z)}$.

But this is to say that the matrix
\begin{align*}
	\left([z_{i}, \overline{z_{j}}]_{\varphi}\right)_{1 \leq i, j \leq 2} =
	\begin{bmatrix}
		[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi} \\
		[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi}
	\end{bmatrix}
\end{align*}
is positive. Now, it just so turns out that ``determinant of the matrix is non-negative" is equivalent to Schwarz-Pick theorem.

Indeed, straightforward although laborious computation shows that
\begin{align}\label{pick2_determinant}
	\det\left(
	\begin{bmatrix}
		[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi} \\
		[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi}
	\end{bmatrix}
	\right)
	=
	\frac{|\varphi(z_{1}) - \varphi(z_{2})|^2}{4 \Im(z_{1}) \Im(z_{2})} \left( d(z_{1}, z_{2})^2 - d(\varphi(z_{1}), \varphi(z_{2})^2)\right).
\end{align}

It is not very hard to generalize the previous argument larger matrices, and we have arrived to
\begin{lause}\label{pick-nevanlinna_theorem}
	If $\varphi$ is Pick function and $z_{1}, z_{2}, \ldots, z_{n}$ are any points in the upper half-plane, then the matrix
	\begin{align}\label{Pick_matrix}
	\begin{bmatrix}
		[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{1}, \overline{z_{n}}]_{\varphi} \\
		[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{2}, \overline{z_{n}}]_{\varphi} \\
		\vdots & \vdots & \ddots & \vdots \\
		[z_{n}, \overline{z_{1}}]_{\varphi} & [z_{n}, \overline{z_{2}}]_{\varphi} & \cdots &  [z_{n}, \overline{z_{n}}]_{\varphi}
	\end{bmatrix}
	\end{align}
	is positive.
\end{lause}

The matrix \ref{Pick_matrix} is called \textit{Pick matrix}.

\begin{proof}
	We have already proved the theorem in the case that $\varphi$ is bounded and extends analytically over the real line. For general case consider the sequence $g_{n}$ of Pick functions given by
	\[
		g_{n}(z) = \frac{(1 - \frac{1}{n})x + \frac{i}{n}}{(1 - \frac{1}{n}) - i\frac{x}{n}} = \toplane \circ \left(z \mapsto \left(1 - \frac{2}{n}\right)z\right) \circ \tocircle.
	\]
	Now
	\begin{enumerate}
		\item $g_{n}(z) \to z$ pointwise.
		\item $g_{n}$'s extend analytically over real line and $g_{n}(\overline{\H_{+}})$ is compact subset of $\H_{+}$ for every $n \geq 1$.
	\end{enumerate}
	It follows $\varphi \circ g_{n} \to \varphi$ pointwise and $\varphi \circ g_{n}$'s satisfy the already proven case. Finally, also the corresponding Pick-matrices of $\varphi \circ g_{n}$'s converge to Pick matrix of $\varphi$, hence the general case.
\end{proof}

\section{Weak characterization}

Theorem \ref{pick-nevanlinna_theorem} has a converse.

\begin{lause}\label{pick-nevanlinna_converse}
	If $\varphi : \Hp \to \Hpc$ such that for any $n \geq 1$ and $z_{1}, z_{2}, \ldots, z_{n} \in \Hp$ the respective Pick matrix
	\begin{align*}
	\begin{bmatrix}
		[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{1}, \overline{z_{n}}]_{\varphi} \\
		[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{2}, \overline{z_{n}}]_{\varphi} \\
		\vdots & \vdots & \ddots & \vdots \\
		[z_{n}, \overline{z_{1}}]_{\varphi} & [z_{n}, \overline{z_{2}}]_{\varphi} & \cdots &  [z_{n}, \overline{z_{n}}]_{\varphi}
	\end{bmatrix}
	\end{align*}
	is positive, then $\varphi$ is a Pick function.
\end{lause}

Note that if all the Pick matrices are positive, function clearly has non-negative imaginary part. Thus we ``only" need to verify analyticity.

Let's first check continuity. For this we only need positivity on $2 \times 2$-matrices.

\begin{lause}\label{pick_continuity_lemma}
	Let $A \subset \Hp$ and $\varphi : A \to \Hpc$ such that for any $z_{1}, z_{2} \in \Hp$ Pick matrix
	\begin{align*}
	\begin{bmatrix}
		[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi}\\
		[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi}\\
	\end{bmatrix}
	\end{align*}
	is positive. Then $f$ is locally Lipschitz, in particular continuous.
\end{lause}
\begin{proof}
	It follows from \ref{pick2_determinant} that we have
	\begin{align*}
		\left|\frac{\varphi(z_{1}) - \varphi(z_{2})}{\varphi(z_{1}) - \overline{\varphi(z_{2})}} \right| \leq \left|\frac{z_{1} - z_{2}}{z_{1} - \overline{z_{2}}} \right|.
	\end{align*}
	for any $z_{1}, z_{2} \in A$; we can draw the same conclusion as in the Schwarz lemma. Now it clearly suffices to check that $\varphi$ is bounded on any compact set. For any compact $K$ there exists $\varepsilon_{K}$ such that the expression
	\begin{align*}
		\left|\frac{z_{1} - z_{2}}{z_{1} - \overline{z_{2}}} \right| < 1 - \varepsilon_{K},
	\end{align*}
	whenever $z_{1}, z_{2} \in K$. If we fix $z_{2} \in K$, it is easily seen that we obtain uniform bound on $|\varphi(z_{1})|$, as
	\begin{align*}
		\lim_{z \to \infty}  \left|\frac{z - w}{z - \overline{w}} \right| = 1.
	\end{align*}
	(Here $\infty$ denotes the complex infinity).
\end{proof}

Curiosly enough, $\varphi$ is analytic as long as all its $3 \times 3$ Pick matrices are positive. This result is known as Hindmarsh's theorem.

\begin{lause}\label{Hindmarsh_theorem}
	Let $U \subset \Hp$ be open and $\varphi : U \to \Hpc$ such that for every $z_{1}, z_{2}, z_{3} \in \Hp$ Pick matrix
	\begin{align*}
	\begin{bmatrix}
		[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi} & [z_{1}, \overline{z_{3}}]_{\varphi}\\
		[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi} & [z_{2}, \overline{z_{3}}]_{\varphi}\\
		[z_{3}, \overline{z_{1}}]_{\varphi} & [z_{3}, \overline{z_{2}}]_{\varphi} & [z_{3}, \overline{z_{3}}]_{\varphi}\\
	\end{bmatrix}
	\end{align*}
	is positive. Then $\varphi$ is analytic.
\end{lause}
\begin{proof}
	We are going to check that the quantity $[z_{1}, z_{2}, z_{3}]_{\varphi}$ is locally bounded, which implies the claim as in the proof of theorem \ref{bounded_div}. 
\end{proof}

As an immediate corollary we get theorem \ref{pick-nevanlinna_converse}.

\begin{proof}[Proof of theorem \ref{pick-nevanlinna_converse}]
If all Pick matrices are positive, so are all $3 \times 3$ Pick matrices.
\end{proof}

We can hence characterize Pick functions purely with Pick matrices, without limits and concerns of regularity, ``weakly". As an immediate corollary we get proposition \ref{pick_convergence}.

\begin{proof}[Proof of theorem \ref{pick_convergence}]
Pointwise limits preserve positivity of the Pick matrices.
\end{proof}

One might still go even further and argue that one does not need Pick matrices larger than $3 \times 3$ to talk about Pick functions. They however carry interesting ``global" information.

\begin{lause}\label{open_pick_nevanlinna}
	Let $U \subset \Hp$ be open and $\varphi : U \to \Hpc$ such that for any $n \geq 1$ and $z_{1}, z_{2}, \ldots, z_{n} \in U$ the respective Pick matrix
	\begin{align*}
	\begin{bmatrix}
		[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{1}, \overline{z_{n}}]_{\varphi} \\
		[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{2}, \overline{z_{n}}]_{\varphi} \\
		\vdots & \vdots & \ddots & \vdots \\
		[z_{n}, \overline{z_{1}}]_{\varphi} & [z_{n}, \overline{z_{2}}]_{\varphi} & \cdots &  [z_{n}, \overline{z_{n}}]_{\varphi}
	\end{bmatrix}
	\end{align*}
	is positive. Then $\varphi$ is a restriction of an unique Pick function.
\end{lause}

This tells us that we may recognise Pick functions from local information. To prove the theorem, we first introduce the notion of \textit{Pick point}.

\begin{maar}
	Let $U \subset \Hp$ be open and $\varphi : U \to \Hpc$. We say that $z \in U$ is Pick point of $\varphi$, if $\varphi$ is analytic at $z$ and the $n \times n$ matrix
	\begin{align*}
	\begin{bmatrix}
		[z, \overline{z}]_{\varphi} & [z, \overline{z}, \overline{z} ]_{\varphi} & \cdots & [z, \overline{z}, \overline{z}, \ldots, \overline{z}]_{\varphi} \\
		[z, z, \overline{z}]_{\varphi} & [z, z, \overline{z}, \overline{z} ]_{\varphi} & \cdots & [z, z, \overline{z}, \overline{z}, \ldots, \overline{z}]_{\varphi} \\
		\vdots & \vdots & \ddots & \vdots \\
		[z, z, \ldots, z, \overline{z}]_{\varphi} & [z, z, \ldots, z, \overline{z}, \overline{z} ]_{\varphi} & \cdots & [z, z, \ldots, z, \overline{z}, \overline{z}, \ldots, \overline{z}]_{\varphi} \\
	\end{bmatrix}
	\end{align*}
	is positive for every $n$.
\end{maar}

Where does this definition come from? The idea is to answer the question: what does it mean the Pick matrices to be non-negative at a single point, say $z_{0}$? In the definition of Pick matrix we could let all the variables be equal and conclude that the matrix
\begin{align*}
\begin{bmatrix}
	[z_{0}, \overline{z_{0}}]_{\varphi} & [z_{0}, \overline{z_{0}}]_{\varphi} & \cdots & [z_{0}, \overline{z_{0}}]_{\varphi} \\
	[z_{0}, \overline{z_{0}}]_{\varphi} & [z_{0}, \overline{z_{0}}]_{\varphi} & \cdots & [z_{0}, \overline{z_{0}}]_{\varphi} \\
	\vdots & \vdots & \ddots & \vdots \\
	[z_{0}, \overline{z_{0}}]_{\varphi} & [z_{0}, \overline{z_{0}}]_{\varphi} & \cdots &  [z_{0}, \overline{z_{0}}]_{\varphi}
\end{bmatrix}
\end{align*}
is positive, but this would only tell us that $[z_{0}, \overline{z_{0}}]_{\varphi}$ is non-negative. We need derivatives.

The idea is to $*$-conjugate the Pick matrix first. Say $n = 2$. If we subtract first row from the second in the Pick matrix
\begin{align*}
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi}\\
	[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi}\\
\end{bmatrix}
\end{align*}
we get
\begin{align*}
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi}\\
	[z_{2}, \overline{z_{1}}]_{\varphi} - [z_{1}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi} - [z_{1}, \overline{z_{2}}]_{\varphi}\\
\end{bmatrix}
=
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi}\\
	(z_{2} - z_{1})[z_{1}, z_{2}, \overline{z_{1}}]_{\varphi} & (z_{2} - z_{1})[z_{1}, z_{2}, \overline{z_{2}}]_{\varphi}
\end{bmatrix}.
\end{align*}
Now subtracting first column from the second results in
\begin{align*}
&\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi} - [z_{1}, \overline{z_{1}}]_{\varphi}\\
	(z_{2} - z_{1})[z_{1}, z_{2}, \overline{z_{1}}]_{\varphi} & (z_{2} - z_{1})[z_{1}, z_{2}, \overline{z_{2}}]_{\varphi} - (z_{2} - z_{1})[z_{1}, z_{2}, \overline{z_{1}}]_{\varphi}
\end{bmatrix} \\
=&
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & \overline{(z_{2} - z_{1})}[z_{1}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi}\\
	(z_{2} - z_{1})[z_{1}, z_{2}, \overline{z_{1}}]_{\varphi} & (z_{2} - z_{1}) \overline{(z_{2} - z_{1})}[z_{1}, z_{2}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi}
\end{bmatrix}.
\end{align*}
In the language of matrices this really says that
\begin{align*}
&\begin{bmatrix}
	1 & 0 \\
	-1 & 1
\end{bmatrix}
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi}\\
	[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi}\\
\end{bmatrix}
\begin{bmatrix}
	1 & -1 \\
	0 & 1
\end{bmatrix} \\
= &
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & \overline{(z_{2} - z_{1})}[z_{1}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi}\\
	(z_{2} - z_{1})[z_{1}, z_{2}, \overline{z_{1}}]_{\varphi} & (z_{2} - z_{1}) \overline{(z_{2} - z_{1})}[z_{1}, z_{2}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi}
\end{bmatrix} \\
= &
\begin{bmatrix}
	1 & 0 \\
	0 & (z_{2} - z_{1})
\end{bmatrix}
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi}\\
	[z_{1}, z_{2}, \overline{z_{1}}]_{\varphi} & [z_{1}, z_{2}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi}
\end{bmatrix}
\begin{bmatrix}
	1 & 0 \\
	0 & \overline{(z_{2} - z_{1})}
\end{bmatrix}:
\end{align*}
matrices
\begin{align*}
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi}\\
	[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi}\\
\end{bmatrix}
\text{ and }
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi}\\
	[z_{1}, z_{2}, \overline{z_{1}}]_{\varphi} & [z_{1}, z_{2}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi}
\end{bmatrix}
\end{align*}
are congruent.

Generalizing this argument we see that the matrices
\begin{gather*}
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{1}, \overline{z_{n}}]_{\varphi} \\
	[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{2}, \overline{z_{n}}]_{\varphi} \\
	\vdots & \vdots & \ddots & \vdots \\
	[z_{n}, \overline{z_{1}}]_{\varphi} & [z_{n}, \overline{z_{2}}]_{\varphi} & \cdots &  [z_{n}, \overline{z_{n}}]_{\varphi}
\end{bmatrix} \\
\text{ and } \\
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{1}, \overline{z_{1}}, \overline{z_{2}}, \ldots, \overline{z_{n}}]_{\varphi} \\
	[z_{1}, z_{2}, \overline{z_{1}}]_{\varphi} & [z_{1}, z_{2}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{1}, z_{2}, \overline{z_{1}}, \overline{z_{2}}, \ldots, \overline{z_{n}}]_{\varphi} \\
	\vdots & \vdots & \ddots & \vdots \\
	[z_{1}, z_{2}, \ldots, z_{n}, \overline{z_{1}}]_{\varphi} & [z_{1}, z_{2}, \ldots, z_{n}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi} & \cdots &  [z_{1}, z_{2}, \ldots, z_{n}, \overline{z_{1}}, \overline{z_{2}}, \ldots, \overline{z_{n}}]_{\varphi}
\end{bmatrix}
\end{gather*}
are congruent. We hence conclude the following.

\begin{lem}
	Let $U \subset \Hp$ be open and $\varphi : U \to \Hpc$. Let $z_{0} \in U$. Assume that for some $r > 0$, for every $n \geq 1$ and $z_{1}, z_{2}, \ldots, z_{n} \in \D(z_{0}, r) \cap U$ the respective Pick matrix is positive. Then $z_{0}$ is Pick point of $\varphi$.
\end{lem}
\begin{proof}
	By theorem \ref{Hindmarsh_theorem} $\varphi$ is analytic at $z_{0}$. By previous observation all the matrices of the form
\begin{align}\label{extended_dobsch_matrix}
\begin{bmatrix}
	[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{1}, \overline{z_{1}}, \overline{z_{2}}, \ldots, \overline{z_{n}}]_{\varphi} \\
	[z_{1}, z_{2}, \overline{z_{1}}]_{\varphi} & [z_{1}, z_{2}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{1}, z_{2}, \overline{z_{1}}, \overline{z_{2}}, \ldots, \overline{z_{n}}]_{\varphi} \\
	\vdots & \vdots & \ddots & \vdots \\
	[z_{1}, z_{2}, \ldots, z_{n}, \overline{z_{1}}]_{\varphi} & [z_{1}, z_{2}, \ldots, z_{n}, \overline{z_{1}}, \overline{z_{2}}]_{\varphi} & \cdots &  [z_{1}, z_{2}, \ldots, z_{n}, \overline{z_{1}}, \overline{z_{2}}, \ldots, \overline{z_{n}}]_{\varphi}
\end{bmatrix}
\end{align}
are positive. By letting $z_{1}, z_{2}, \ldots, z_{n} \to z_{0}$ we get the claim.
\end{proof}
Matrix \ref{extended_dobsch_matrix} is called \textit{extended Pick matrix}.

Again, one can, and should, interpret the extended Pick matrix as some kind of change of basis. In terms of a Cauchy's integral formula the original Pick matrix says that
\begin{align*}
	\Re\left(\frac{1}{2 \pi i} \int_{\gamma} \left(\sum_{j = 1}^{n} \frac{c_{j}}{z - \lambda_{j}}\right)\left(\sum_{j = 1}^{n} \frac{\overline{c_{j}}}{z - \overline{\lambda_{j}}}\right) \varphi(z) dz \right) \geq 0,
\end{align*}
for any $c_{1}, c_{2}, \ldots, c_{n} \in \C$ and $\lambda_{1}, \lambda_{2}, \ldots, \lambda_{n} \in U$ while the extended Pick matrix says that
\begin{align*}
	\Re\left(\frac{1}{2 \pi i} \int_{\gamma} \left(\sum_{j = 1}^{n} \frac{c_{j}}{\prod_{1 \leq j' \leq j}(z - \lambda_{j'})}\right)\left(\sum_{j = 1}^{n} \frac{\overline{c_{j}}}{\prod_{1 \leq j' \leq j}(z - \overline{\lambda_{j'}})}\right) \varphi(z) dz \right) \geq 0
\end{align*}
for any $c_{1}, c_{2}, \ldots, c_{n} \in \C$ and $\lambda_{1}, \lambda_{2}, \ldots, \lambda_{n} \in U$. This interpretation makes it clear that two different matrices are really about
\begin{gather*}
	\frac{1}{z - \lambda_{1}}, \frac{1}{z - \lambda_{2}}, \ldots, \frac{1}{z - \lambda_{n}} \\
	\text{and} \\
	\frac{1}{z - \lambda_{1}}, \frac{1}{(z - \lambda_{1})(z - \lambda_{2})}, \ldots, \frac{1}{(z - \lambda_{1}) (z - \lambda_{2}) \cdots (z - \lambda_{n})}
\end{gather*}
spanning the same set of rational functions (whenever $\lambda_{i}$'s are pairwise distinct).

The idea of the proof of theorem \ref{open_pick_nevanlinna} is the following: we try to make every point in $\Hp$ is Pick point of $\varphi$. For this we need two lemmas. first one says that if point is a Pick point of $\varphi$, then $\varphi$ can be extended to a reasonable large disc around $z_{0}$, which is really to say that the Taylor coefficients of $\varphi$ at $z_{0}$ don't grow too fast. Second one tells us that if we managed to extend function to such disc, then all the points in the disc are Pick points.

\begin{lem}
	There exists absolute constant $c_{0}$ with the following property: Let $U \subset \Hp$ be open and $\varphi : U \to \Hpc$. Assume that $z_{0} \in U$ is a Pick point of $U$. Then the Taylor series of $\varphi$ at $z_{0}$ converges in $\D(z_{0}, c_{0} \Im(z_{0}))$. One may take $c_{0} = \frac{1}{9}$.
\end{lem}
\begin{proof}
	By affine transformation we may assume that $z_{0} = i$ and $\varphi(i) = i$. We should prove that there exists an absolute constant $C_{0}$ such that $\left|\frac{\varphi^{(n)}(i)}{n!}\right| \leq C_{0}^{n + 1}$ for any $n$. Write $a_{k} = \varphi^{(k)}(i)/k!$. The claim follows quite easily if we can prove that for some constant $C_{0}'$. We have
	\begin{align*}
		|a_{k}| \leq C_{0}' \sum_{i = 0}^{k - 1} |a_{i}|
	\end{align*}
	for $k \geq 1$.

	We are going to express the entries of the Dobsch matrix with respect to the Taylor coefficients.

	For convenience, write
	\begin{align*}
		b_{k} = a_{k} (-2 i)^{k + 1}
	\end{align*}

	By staightforvard induction one sees that
	\begin{align*}
		&[i, i, \ldots, i, -i, -i, \ldots, -i]_{\varphi} \\
		&= \frac{1}{(-2i)^{k_{1}} (2 i)^{k_{2}}} \left( \sum_{j = 0}^{n - 1} b_{j} \binom{m + n - 2 - j}{m - 1} + \sum_{j = 0}^{m - 1} \overline{b_{j}} \binom{m + n - 2 - j}{n - 1}\right).
	\end{align*}
	where $i$ and $-i$ appear $k_{1}$ and $k_{2}$ times in the divided difference.

	The idea is to look at the $n \times n$ matrix and conclude the inequality for $b_{n - 1}$. It turns out that it is sufficient to look at the submatrix consisting of only first and the last row and column. We may interpret the resulting matrix as sum of $n$ matrices $A_{j}$, $0 \leq j \leq n - 1$, namely
	\begin{align*}
		A_{j} =
		\begin{cases}
			\begin{bmatrix}
				\frac{1}{4}(b_{0} + \overline{b_{0}}) & \frac{1}{(-2i)^{n}(2i)}(b_{0} + \overline{b_{0}}) \\
				\frac{1}{(-2 i)(2 i)^{n}}(b_{0} + \overline{b_{0}}) &  \frac{\binom{2 n - 2}{n - 1}}{2^{2 n}}(b_{0} + \overline{b_{0}})
			\end{bmatrix}
			& \text{ if } j = 0 \\
			\begin{bmatrix}
				0 &  \frac{1}{(-2i)^{n}(2i)}b_{j} \\
				\frac{1}{(-2 i)(2 i)^{n}}\overline{b_{j}} & \frac{\binom{2 n - 2 - j}{n - 1}}{2^{2 n}}(b_{j} + \overline{b_{j}})
			\end{bmatrix}
			& \text{ otherwise}.
		\end{cases}
	\end{align*}
	Using the trivial inequality $\binom{2 n - 2 - j}{n - 1} \leq 2^{2 n - 2 - j}$ one easily sees that $\|A_{j}\| \leq 2^{-j}|b_{j}|$ for any $0 \leq j \leq n - 1$. Additionally it is easy to verify that $A_{n - 1}$ has negative eigenvalue with absolute value at least $2^{- n - 2}|b_{n - 1}|$.

	It follows that
	\begin{align*}
		\frac{|b_{n - 1}|}{2^{n - 1}} \leq 8 \sum_{j = 0}^{n - 2} \frac{|b_{j}|}{2^{j}},
	\end{align*}
	which implies that
	\begin{align*}
		|a_{n - 1}| \leq 8 \sum_{j = 0}^{n - 2} |a_{j}|.
	\end{align*}
	Since $a_{0} = 1$, we see by induction that $|a_{j}| \leq 9^{j}$, and we may hence take $c_{0} = \frac{1}{9}$.
\end{proof}

\begin{lem}\label{pick_point_lemma}
	Let $U \subset \Hp$ be open and $\varphi : U \to \Hpc$. Let $z_{0} \in U$ and $0 < r \leq \Im(z_{0})$. Assume that $z_{0}$ is Pick point of $\varphi$ and $\varphi$ is analytic in $\D(z_{0}, r)$. Then all Pick matrices of $\varphi$ are positive on $\D(z_{0}, r)$. Consequently, all the points in $\D(z_{0}, r)$ are Pick points of $z_{0}$.
\end{lem}
\begin{proof}
	Rewriting things with Cauchy's integral formula, our goal is to prove that for any $c_{1}, c_{2}, \ldots, c_{n} \in \C$ and $\lambda_{1}, \lambda_{2}, \ldots, \lambda_{n} \in \D(z_{0}, r)$ we have
	\begin{align*}
		\Re\left(\frac{1}{2 \pi i} \int_{\gamma} \left(\sum_{j = 1}^{n} \frac{c_{j}}{z - \lambda_{j}}\right)\left(\sum_{j = 1}^{n} \frac{\overline{c_{j}}}{z - \overline{\lambda_{j}}}\right) \varphi(z) dz \right) \geq 0
	\end{align*}
	where $\gamma$ traces a circle centered at $z_{0}$, enclosing the $\lambda$'s. What we know, again, in terms of Cauchy's integral formula, is that for any $c_{1}', c_{2}', \ldots, c_{n}' \in \C$ we have
	\begin{align*}
		\Re\left(\frac{1}{2 \pi i} \int_{\gamma} \left(\sum_{j = 1}^{n} \frac{c_{j}'}{(z - z_{0})^{j}}\right) \left(\sum_{j = 1}^{n}\frac{\overline{c_{j}'}}{(z - \overline{z_{0}})^{j}}\right) \varphi(z) dz\right) \geq 0.
	\end{align*}
	The idea is to simply approximate upper integrand: if we manange to approximate terms of the form $\frac{1}{z - \lambda}$ uniformly on $\gamma$ by terms of the form $\sum_{j = 1}^{n} \frac{c_{j}'}{(z - z_{0})^{j}}$, then we can certainly make our goal expression as close to a non-negative number as we wish. But this is exactly what Laurent expansions are for.

	One should not forget that also the conjugate part should be approximated, but since $|\overline{z} - z_{0}| > |z - z_{0}|$ for any $z \in \Hp$, the conjugated approximation is even better.
\end{proof}

\begin{proof}[Proof of theorem \ref{open_pick_nevanlinna}]
	Consider all open sets $U \subset V \subset \Hp$ such that $\varphi$ may be extended to $V$ so that all the points of $V$ are Pick points of $\varphi$ (or the extension thereof). These sets trivially satisfy conditions of Zorn's lemma (where partial order is given by inclusion) so we may Pick maximal such set, $V$. We claim that this set is $\Hp$. If not, we may pick a point $z_{0}$ in $\Hp \cap \partial V$. Now pick $z \in V$ such that $|z - z_{0}| < \Im(z_{0}) c_{0}$: we may extend $\varphi$ now further to $\D(z_{0}, c_{0} \Im(z_{0}))$ by Taylor series and all points in the extension are Pick points, which contradicts the maximality.
\end{proof}

There is fundamental flaw with the second argument: when we extend $\varphi$ with Taylor series, how do we know that these extensions are consistent? If original set $U$ was, say, disjoint union of two discs, and Taylor series centered at a point of one disc would converge also at (some part of) other disc, how do we know that the Taylor series converges to the predefined values in the one disc? This is not at all clear.

If $U$ is disc or more generally domain, we can use the monodromy theorem to show that this kind of extension is indeed possible. Indeed, upper half-plane is simply connected and by the previous lemmas we can continue $\varphi$ along any path. This, however, still doesn't fix the problem with two disjoint discs.

We can salvage the proof by improving the second lemma. We have to somehow remember the information of the positivity of all the Pick matrices, otherwise we might run into problem. Let's have notion for this.

\begin{maar}
	Let $U \subset \Hp$ be open and $\varphi : U \to \Hpc$. We call $\varphi$ \textit{weakly Pick}, or say it is \textit{weak Pick function} if all its Pick matrices are positive.
\end{maar}

\begin{lem}
	Let $U \subset \Hp$ be open and $\varphi : U \to \Hpc$ weakly Pick. Assume that for some $z_{0} \in U$ and $r > 0$ the Taylor series of $\varphi$ at $z_{0}$ converges in $\D(z_{0}, r)$. Then the values of Taylor series in $\D(z_{0}, r) \cap U$ coincide with $\varphi$ and the resulting extension is weakly Pick in $U \cup \D(z_{0}, r)$.
\end{lem}
\begin{proof}
	Let us first show that the extension coincides with the original function. Note that this not all that obvious and fails if without the weakly Pick -condition.

	To do that, let $\tilde{\varphi} : \D(z_{0}, r) \to \C$ be the extension and let $z_{1} \in \D(z_{0}, r)$ and $z_{2} \in U$ be distinct. We prove that the matrix
	\begin{align*}
		\begin{bmatrix}
		\frac{\tilde{\varphi}(z_{1}) -  \overline{\tilde{\varphi}(z_{1})}}{z_{1} - \overline{z_{1}}} & \frac{\tilde{\varphi}(z_{1}) -  \overline{\varphi(z_{2})}}{z_{1} - \overline{z_{2}}} \\
		\frac{\varphi(z_{2}) -  \overline{\tilde{\varphi}(z_{1})}}{z_{2} - \overline{z_{1}}} & \frac{\varphi(z_{2}) -  \overline{\varphi(z_{2})}}{z_{2} - \overline{z_{2}}}
		\end{bmatrix}
	\end{align*}
	is positive. As observed before, this shows that $|\tilde{\varphi}(z_{1}) - \varphi(z_{2})| \leq C_{\varphi, z_{2}} |z_{1} - z_{2}|$ which implies the claim. We could also consider the matrix where $z_{1}$ and $z_{2}$ are equal, but this is just for notational convenience.

	The idea is to try to do the same thing as in the proof of lemma \ref{pick_point_lemma}. The problem is that we can't a priori express both $\varphi(z_{1})$ and $\tilde{\varphi}(z_{1})$ with Cauchy's integral formula with the same contour. But we can still follow the same approximation scheme, one just has to be more careful about error terms.

	To make the notation slightly simpler 

	If we already knew that the result was true, the positivity of matrix desired would be same as positivity of the real part of
	\begin{align*}
		\frac{1}{2 \pi i}\int_{\gamma} \left(\frac{c_{1}}{z - z_{1}} + \frac{c_{2}}{z - z_{2}} \right)  \left(\frac{\overline{c_{1}}}{z - \overline{z_{1}}} + \frac{\overline{c_{2}}}{z - \overline{z_{2}}} \right)\varphi(z) dz.
	\end{align*}

	Plugging the identity
	\begin{align*}
	\frac{1}{z - z_{1}} = \sum_{j = 1}^{n} \frac{(z_{1} - z_{0})^{j - 1}}{(z - z_{0})^{j}} + \frac{(z_{1} - z_{0})^{n}}{(z - z_{1})(z - z_{0})^{n}}
	\end{align*}
	in the previous integral we arrive at
	\begin{align*}
		&\frac{1}{2 \pi i}\int_{\gamma} \left(\sum_{j = 1}^{n} \frac{c_{1}(z_{1} - z_{0})^{j - 1}}{(z - z_{0})^{j}}  + \frac{c_{2}}{z - z_{2}} \right)  \left(\sum_{j = 1}^{n} \frac{\overline{c_{1}} (\overline{z_{1}} - \overline{z_{0}})^{j - 1}}{(z - \overline{z_{0}})^{j}} + \frac{\overline{c_{2}}}{z - \overline{z_{2}}} \right) \varphi(z) dz\\
		+&\frac{1}{2 \pi i}\int_{\gamma} \left(\frac{c_{1}(z_{1} - z_{0})^{n}}{(z - z_{1})(z - z_{0})^{n}}\right) \left(\sum_{j = 1}^{n} \frac{\overline{c_{1}} (\overline{z_{1}} - \overline{z_{0}})^{j - 1}}{(z - \overline{z_{0}})^{j}}\right) \varphi(z) dz\\
		+&\frac{1}{2 \pi i}\int_{\gamma} \left(\frac{c_{1}(z_{1} - z_{0})^{n}}{(z - z_{1})(z - z_{0})^{n}}\right) \left(\frac{\overline{c_{2}}}{z - \overline{z_{2}}} \right) \varphi(z) dz\\
		+&\frac{1}{2 \pi i}\int_{\gamma} \left(\frac{c_{1}(z_{1} - z_{0})^{n}}{(z - z_{1})(z - z_{0})^{n}}\right) \left(\frac{\overline{c_{1}}(\overline{z_{1}} - \overline{z_{0}})^{n}}{(z - \overline{z_{1}})(z - \overline{z_{0}})^{n}}\right) \varphi(z) dz \\
		+& \frac{1}{2 \pi i}\int_{\gamma} \left(\sum_{j = 1}^{n} \frac{c_{1}(z_{1} - z_{0})^{j - 1}}{(z - z_{0})^{j}}\right) \left(\frac{\overline{c_{1}}(\overline{z_{1}} - \overline{z_{0}})^{n}}{(z - \overline{z_{1}})(z - \overline{z_{0}})^{n}}\right) \varphi(z) dz \\
		+& \frac{1}{2 \pi i}\int_{\gamma} \left(\frac{c_{2}}{z - z_{2}}\right) \left(\frac{\overline{c_{1}}(\overline{z_{1}} - \overline{z_{0}})^{n}}{(z - \overline{z_{1}})(z - \overline{z_{0}})^{n}}\right) \varphi(z) dz.
	\end{align*}
	Note all this could be expanded as sum linear combination of $\varphi(z_{1}), \varphi(z_{2})$ and $\varphi^{(j)}(z_{0})$ for $0 \leq j \leq n - 1$. Should one do that, the resulting identity would hold without any additional (to the lemma statement) smootness assumptions. The point again is that the first row gives the main term, and we know that it is non-negative. It hence suffices to prove that remaining terms tend to zero as $n \to \infty$.

	Terms without $z_{2}$ are easy to estimate directly as they make also make honest sense. We can take $\gamma$ to be circle of radius $r'$ for some $|z_{1} - z_{0}| < r' < r$. Then for instance the first error term can be bounded by
	\begin{align*}
		\frac{|c_{1} c_{2}| |z_{1} - z_{0}|^{n}(r - r')}{r'^{n}} \left(\sum_{j = 1}^{n} \frac{|z_{1} - z_{0}|^{j - 1}}{{r'}^{j}}\right) \sup_{z \in \partial \D(z_{0}, r')}|\varphi(z)|,
	\end{align*}
	which clearly tends to $0$.

	With $z_{2}$ terms one has to be bit more careful. First, write
	\begin{align*}
		& \frac{1}{2 \pi i}\int_{\gamma} \left(\frac{c_{1}(z_{1} - z_{0})^{n}}{(z - z_{1})(z - z_{0})^{n}}\right) \left(\frac{\overline{c_{2}}}{z - \overline{z_{2}}} \right) \varphi(z) dz \\
		= & \frac{c_{1} \overline{c_{2}}}{z_{1} - \overline{z_{2}}}\frac{1}{2 \pi i}\int_{\gamma} \left(\frac{(z_{1} - z_{0})^{n}}{(z - z_{1})(z - z_{0})^{n}}\right) \varphi(z) dz \\
		-& \frac{c_{1} \overline{c_{2}}}{z_{1} - \overline{z_{2}}}\frac{1}{2 \pi i}\int_{\gamma} \left(\frac{c_{1}(z_{1} - z_{0})^{n}}{(z - \overline{z_{2}})(z - z_{0})^{n}}\right) \varphi(z) dz.
	\end{align*}
	First term is again easily estimated. The second integrand, so far formal, can be written as a sum
	\begin{align*}
		& \frac{(z_{1} - z_{0})^{n}}{(z - \overline{z_{2}})(z - z_{0})^{n}} \varphi(z)\\
		=& \frac{(z_{1} - z_{0})^{n}}{(z - \overline{z_{2}})(z_{0} - \overline{z_{2}})^{n}}\varphi(z) - \sum_{i = 1}^{n} \frac{(z_{1} - z_{0})^{n}}{(z - z_{0})^{j} (z_{0} - \overline{z_{2}})^{n + 1 - j}}\varphi(z).
	\end{align*}
	First term evaluates to $0$ and the other terms are again easily estimated. For the another $z_{2}$ only
	\begin{align*}
		\frac{(z_{1} - z_{0})^{n}}{(z_{0} - \overline{z_{2}})^{n}} \varphi(z_{0})
	\end{align*}
	remains.

	This argument also essentially proves that the extension is weakly Pick. We should prove that for any $n_{1}, n_{2} \geq 0$ and $z_{1}, \ldots, z_{n_{1}}, w_{1}, \ldots, w_{n_{2}} \in \C$ the matrix
	\begin{align*}
		\begin{bmatrix}
			\frac{\tilde{\varphi}(z_{1}) - \overline{\tilde{\varphi}(z_{1})}}{z_{1} - \overline{z_{1}}} & \cdots & \frac{\tilde{\varphi}(z_{1}) - \overline{\tilde{\varphi}(z_{n_{1}})}}{z_{1} - \overline{z_{n_{1}}}} & \frac{\tilde{\varphi}(z_{1}) - \overline{\varphi(w_{1})}}{z_{1} - \overline{w_{1}}} & \ldots & \frac{\tilde{\varphi}(z_{1}) - \overline{\varphi(w_{n_{2}})}}{z_{1} - \overline{w_{n_{2}}}} \\
			\vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
			\frac{\tilde{\varphi}(z_{n_{1}}) - \overline{\tilde{\varphi}(z_{1})}}{z_{1} - \overline{z_{1}}} & \cdots & \frac{\tilde{\varphi}(z_{n_{1}}) - \overline{\tilde{\varphi}(z_{n_{1}})}}{z_{1} - \overline{z_{n_{1}}}} & \frac{\tilde{\varphi}(z_{n_{1}}) - \overline{\varphi(w_{1})}}{z_{1} - \overline{w_{1}}} & \ldots & \frac{\tilde{\varphi}(z_{n_{1}}) - \overline{\varphi(w_{n_{2}})}}{z_{1} - \overline{w_{n_{2}}}} \\
			\frac{\varphi(w_{1}) - \overline{\tilde{\varphi}(z_{1})}}{w_{1} - \overline{z_{1}}} & \cdots & \frac{\varphi(w_{1}) - \overline{\tilde{\varphi}(z_{n_{1}})}}{w_{1} - \overline{z_{n_{1}}}} & \frac{\varphi(w_{1}) - \overline{\varphi(w_{1})}}{w_{1} - \overline{w_{1}}} & \ldots & \frac{\varphi(w_{1}) - \overline{\varphi(w_{n_{2}})}}{w_{1} - \overline{w_{n_{2}}}} \\
			\vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
			\frac{\varphi(w_{n_{2}}) - \overline{\tilde{\varphi}(z_{1})}}{w_{n_{2}} - \overline{z_{1}}} & \cdots & \frac{\varphi(w_{n_{2}}) - \overline{\tilde{\varphi}(z_{n_{1}})}}{w_{n_{2}} - \overline{z_{n_{1}}}} & \frac{\varphi(w_{n_{2}}) - \overline{\varphi(w_{1})}}{w_{n_{2}} - \overline{w_{1}}} & \ldots & \frac{\varphi(w_{n_{2}}) - \overline{\varphi(w_{n_{2}})}}{w_{n_{2}} - \overline{w_{n_{2}}}} \\
		\end{bmatrix}
	\end{align*}
	is positive. Formally, this would mean that for any $c_{1}, \ldots, c_{n_{1}}, d_{1}, \ldots, d_{n_{2}} \in \C$ the real part of the integral
	\begin{align*}
		\frac{1}{2 \pi i}\int_{\gamma} \left(\sum_{i = 1}^{n_{1}} \frac{c_{i}}{z - z_{i}} + \sum_{i = 1}^{n_{2}} \frac{d_{i}}{z - w_{i}}\right) \left(\sum_{i = 1}^{n_{1}} \frac{\overline{c_{i}}}{z - \overline{z_{i}}} + \sum_{i = 1}^{n_{2}} \frac{\overline{d_{i}}}{z - \overline{w_{i}}}\right) \varphi(z) dz
	\end{align*}
	is positive. But one can simply do the same Laurent expansion, and error terms are estimated completely analogously.
\end{proof}

\begin{proof}[Fix of the proof of theorem \ref{open_pick_nevanlinna}]
Now the Zorn's lemma works if we change the condition a bit: we look at all the weakly Pick extensions of $\varphi$ to open subsets of upper half-plane.

Zorn's lemma is not really necessary here: one could write explicit extension scheme (TODO: picture) and the lemmas would guarantee that we can always both extend further and extensions are always consistent and weakly Pick.
\end{proof}

\section{Pick-Nevanlinna Interpolation theorem}

One can still considerably strenghten theorem \ref{open_pick_nevanlinna}: instead of open set, domain of $\varphi$ could be any set. Then we don't in general have unique extension. This is the content of Pick-Nevanlinna interpolation theorem.

\begin{lause}[Pick-Nevanlinna interpolation theorem]\label{pick_nevanlinna_interpolation}
	Let $A \subset \H_{+}$ and $\varphi : A \to \Hpc$ weakly Pick. Then $\varphi$ is a restriction of a Pick function to $A$.
\end{lause}

Note that the notion of weak Pick functions makes perfect sense in this more general setting. In the general setting we can't use Taylor series to extend the function anymore, but it turns out that this is not too big of a problem. The idea is again to extend $\varphi$ to larger and larger sets. Note that to do this we only need to be able to extend $\varphi$ to one new point so that all Pick matrices are again positive: we can then use the Zorn's lemma -trick again.

Before the proof we need an interesting fact\footnote{We don't really need, but it is an interesting fact nonetheless.}.

\begin{lem}\label{disc_lemma}
	Let $\mathcal{D}$ be a non-empty family of (non-empty) closed discs such that for any $\D_{1}, \D_{2} \in \mathcal{D}$ there exists $\mathcal{D} \ni \D_{3} \subset \D_{1} \cap \D_{2}$. Then
	\begin{align*}
		\bigcap_{\D \in \mathcal{D}} \D
	\end{align*}
	is a (non-empty) closed disc.
\end{lem}
\begin{proof}
	Denote the intersection by $K$. Since $\mathcal{D}$ is family of compact sets with finite intersection property, $K$ is non-empty compact set. Hence we may take two points in $K$ with largest distance. If the points are equal, the intersection is a single points, and we are done. If not, without loss of generality we may assume that the points are $-1$ and $1$. Our aim is to prove that $K$ equals $\overline{\D}(0, 1)$.

	Fix $r > 1$. We claim that there exists a disc $\D \in \mathcal{D}$ such that $\D$ is contained in the strip $S_{r} := \{z \in \C | |\Re(z)| < r\}$. For this note that for any $M > 0$ the family $\{[r - i M, r + i M] \cap \D | \D \in \mathcal{D}\}$ (where $[r - i M, r + i M]$ denotes the closed interval from $r - i M$ to $r + i M$) is family of compact sets with empty intersection, so they have finite subfamily with empty intersection. By the main condition if follows that we find a disc in $\mathcal{D}$ with empty intersection with the interval. Taking $M$ large enough we see that one of the discs has empty intesection with the line $\{z \in \C | \Re(z) = r\}$. Playing the same game with $-r$ and taking the intersection we find the required disc.

	Next we claim that for any $r' < 1$ any disc in the family contains $\D(0, r')$. Note that since all the discs in the family have radius at least $1$, this is certainly true for any disc with center close enough to $0$. If $\D_{0} \in S_{r}$ has center $z_{0}$, we have $2 r^{2} \geq |1 - z_{0}|^2 + |1 + z_{0}|^2 = 2 + 2 |z_{0}|^2$. Taking $r$ close to $1$ we see that $z_{0}$ is close to $0$ and hence $\D_{0}$ contains $\D(0, r')$. Since by the intersection property every disc in $\mathcal{D}$ contains disc in $S_{r}$, also the second claim is proven.

	Now as $K$ as compact, it contains the closed disc $\overline{\D}(0, 1)$. But since $K$ has diameter $2$, it can't contain anything else, so $K = \overline{\D}(0, 1)$ and we are done.

	TODO picture
\end{proof}

Not surprisingly, the result remains true also in higher dimensions, as can be seen for instance by intersecting the closed balls with two dimensional planes and applying the 2d case.

\begin{lem}\label{pick_extension_lemma}
	Let $A \subset \H_{+}$ and $\varphi : A \to \Hpc$ weakly Pick. Then if $z_{0} \in \Hp \setminus A$ there exists $w_{0} \in \Hpc$ such that if we extend $\varphi$ to $z_{0}$ by setting $\varphi(z_{0}) = w_{0}$, also the extension is weakly Pick.
\end{lem}
\begin{proof}
	Let's first consider the case of finite $A$, say $A = \{z_{1}, z_{2}, \ldots, z_{n}\}$ and denote $w_{i} = \varphi(z_{i})$. We should find $w_{0}$ such that the matrix
	\begin{align*}
		\begin{bmatrix}
			\frac{w_{0} - \overline{w_{0}}}{z_{0} - \overline{z_{0}}} & \frac{w_{0} - \overline{w_{1}}}{z_{0} - \overline{z_{1}}} & \cdots & \frac{w_{0} - \overline{w_{n}}}{z_{0} - \overline{z_{n}}} \\
			\frac{w_{1} - \overline{w_{0}}}{z_{1} - \overline{z_{0}}} & \frac{w_{1} - \overline{w_{1}}}{z_{1} - \overline{z_{1}}} & \cdots & \frac{w_{1} - \overline{w_{n}}}{z_{1} - \overline{z_{n}}} \\
			\vdots & \vdots & \ddots & \vdots \\
			\frac{w_{n} - \overline{w_{0}}}{z_{n} - \overline{z_{0}}} & \frac{w_{n} - \overline{w_{1}}}{z_{n} - \overline{z_{1}}} & \ldots & \frac{w_{n} - \overline{w_{n}}}{z_{n} - \overline{z_{n}}}
		\end{bmatrix}
	\end{align*}
	is positive. Denote the matrix consisting of the last $n$ rows and columns of the matrix by $n$. We first assume that $M$ is invertible. Then the original matrix is positive if and only the the Schur complement with respect to the last $n$ rows is positive, that is
	\begin{align*}
		0 \leq &\frac{w_{0} - \overline{w_{0}}}{z_{0} - \overline{z_{0}}} - (w_{0} v - w)^{*} M^{-1} (w_{0} v - w) \\
		=& -\langle M^{-1} v, v \rangle |w_{0}|^2 + \left(\frac{1}{z_{0} - \overline{z_{0}}} + \langle M^{-1} v, w \rangle \right) w_{0} \\
		&+  \left(-\frac{1}{z_{0} - \overline{z_{0}}} + \langle M^{-1} w, v \rangle \right) \overline{w_{0}} - \langle M^{-1} w, w \rangle \\
		=&  -\frac{1}{\langle M^{-1} v, v \rangle} \left|\langle M^{-1} v, v \rangle w_{0} +  \frac{1}{z_{0} - \overline{z_{0}}} - \langle M^{-1} w, v \rangle\right|^{2} \\
		&+ \frac{\left|\frac{1}{z_{0} - \overline{z_{0}}} - \langle M^{-1} w, v \rangle\right|^{2} - \langle M^{-1} v, v \rangle\langle M^{-1} w, w \rangle}{\langle M^{-1} v, v \rangle}
	\end{align*}
	where $v = (\frac{1}{z_{0} - \overline{z_{i}}})_{i = 1}^{n}$ and $w = (\frac{\overline{w_{i}}}{z_{0} - \overline{z_{i}}})_{i = 1}^{n}$. Now if we manage to prove that
	\begin{align*}
	\left|\frac{1}{z_{0} - \overline{z_{0}}} - \langle M^{-1} w, v \rangle\right|^{2} - \langle M^{-1} v, v \rangle\langle M^{-1} w, w \rangle \geq 0,
	\end{align*}
	we can choose suitable $w_{0}$ and moreover set of suitable $w_{0}$'s is a closed disc.

	The positivity follows from the following formula:
	\begin{align*}
		\left|\frac{1}{z_{0} - \overline{z_{0}}} - \langle M^{-1} w, v \rangle\right|^{2} - \langle M^{-1} v, v \rangle\langle M^{-1} w, w \rangle = \prod_{i = 1}^{n} \left|\frac{z_{i} - z_{0}}{z_{i} - \overline{z_{0}}}\right|^{2} = \prod_{i = 1}^{n} \tilde{d}(z_{1}, z_{0})^{2}
	\end{align*}
	Where does this come from? The idea is that the Pick matrix is of a really special form and as one easily checks, one has
	\begin{align*}
		\frac{w_{k} - \overline{w_{l}}}{z_{k} - \overline{z_{l}}} -\frac{w_{k} - \overline{z_{0}}}{z_{k} - \overline{z_{0}}}\frac{\overline{w_{l}} - z_{0}}{\overline{z_{l}} - z_{0}} +  \frac{w_{k} - z_{0}}{z_{k} - \overline{z_{0}}}\frac{\overline{w_{l}} - \overline{z_{0}}}{\overline{z_{l}} - z_{0}} = \frac{z_{k} - z_{0}}{z_{k} - \overline{z_{0}}}\frac{\overline{z_{l}} - \overline{z_{0}}}{\overline{z_{l}} - z_{0}}\frac{w_{k} - \overline{w_{l}}}{z_{k} - \overline{z_{l}}}.
	\end{align*}
	This identity can be interpreted as $(M - v_{1} v_{1}^{*}) + v_{2} v_{2}^{*} = D^{*} M D$ where $v_{1}, v_{2}$ are some vectors and $D$ a diagonal matrix. Calculating the determinant from both sides, by multiplicativity on the right-hand side and using rank 1 update formulas in the bracketed order on the left-hand side, one will end up with the sought formula.

	If $M$ is singular, one has to be bit careful. The trick is to shift the tuple a bit.

	The matrix $\left(\frac{2 i}{z_{k} - \overline{z_{l}}}\right)_{1 \leq k,l \leq n}$ is strictly positive for any tuple of distinct numbers $z_{1}, \ldots, z_{n} \in \Hp$. Indeed, by the residue theorem we have
	\begin{align*}
		\sum_{1 \leq k,l \leq n} c_{k} \overline{c_{l}} \frac{2 i}{z_{k} - \overline{z_{l}}} = \frac{1}{2 \pi}\int_{-\infty}^{\infty} \left|\sum_{k = 1}^{n} \frac{c_{k}}{t - z_{k}}\right|^{2} d t
	\end{align*}
	and if the integrand is zero almost everywhere, and hence on at least $n$ points, then $c_{i}$'s are all zero.

	Consequently, consider the extension problem for the values $w_{k} + \varepsilon i$ for some $\varepsilon > 0$, and let $D_{\varepsilon} + \varepsilon i$ be the respective set of suitable $w_{0}$'s for given $\varepsilon$. Since clearly $D_{\varepsilon} \subset D_{\varepsilon'}$ for any $\varepsilon \leq \varepsilon'$ and $D_{\varepsilon}$'s are closed discs, by lemma \ref{disc_lemma} the intersection
	\begin{align*}
		\cap_{\varepsilon > 0} D_{\varepsilon} =: D_{0}
	\end{align*}
	is also a closed disc, and one easily sees that it is exactly the set of suitable $w_{0}$'s.

	Let's now consider case of arbitrary $A$. For every finite subset $F \subset A$ we know that the set of suitable $w_{0}$'s, say $W_{F}$, is a closed disc. We also know that $W_{F_{1} \cup F_{2}} \subset W_{F_{1}} \cap W_{F_{2}}$. But now it follows that the family
	\begin{align*}
		\{W_{F} \subset \Hp | \text{$F$ is finite (non-empty) subset of $A$} \}
	\end{align*}
	satisfies the conditions of the lemma \ref{disc_lemma} and hence the intersection is a closed disc. This intersection is exactly the set of suitable $w_{0}$'s.

	TODO: express this as a hyperbolic disc with canonical center.
\end{proof}

\begin{proof}[Proof of theorem \ref{pick_nevanlinna_interpolation}]
Let us consider the set of all weakly Pick extensions of $\varphi$, ordered by restriction. This family trivially satisfies conditions of the Zorn's lemma, so there's a maximal element, $\varphi_{0}$. But by the previous lemma $\varphi_{0}$ must be defined in the whole upper half-plane, since if not, we could extend it to one more point. Finally, by theorem \ref{pick-nevanlinna_converse} the resulting map is Pick function.
\end{proof}

Again, one doesn't really need the Zorn's lemma.

\begin{proof}[Alternate proof of theorem \ref{pick_nevanlinna_interpolation}]
	If $\Hp \setminus A$ is finite, simply apply lemma \ref{pick_extension_lemma} repeatedly. If not, we may pick a countable dense set in $C \subset \Hp \setminus A$ and extend $\varphi$ there. As a result we get a map in a dense subset of upper half-plane, which is continuous by lemma \ref{pick_continuity_lemma}. This means that we have continuous extension to whole upper half-plane, and by continuity also all the Pick matrices of the extension are positive. Finally, by theorem \ref{pick-nevanlinna_converse} the final extension is a Pick function.
\end{proof}

\section{Schur transform}

Properties of Pick functions translate nicely to those of positive maps. Most obvious of these properties is the cone structure: Pick matrix is linear in the function. The automorphims of the upper half-plane correspond to one dimensional projections. Indeed, Pick matrix of map of the form $z \mapsto \frac{a z + b}{c z + d}$ is given by
\begin{align*}
	\left[\frac{\frac{a z_{i} + b}{c z_{i} + d} - \frac{a \overline{z_{j}} + b}{c \overline{z_{j}} + d}}{z_{i} - \overline{z_{j}}}\right]_{i, j = 1}^{n}
	=
	\left[\frac{a d - bc}{(c z_{i} + d) (c \overline{z_{i}} + d)}\right]_{i, j = 1}^{n},
\end{align*}
which is of rank $1$. Composition corresponds to Hadamard product: if $\varphi = \varphi_{2} \circ \varphi_{1}$, we have
\begin{align*}
	\left[\frac{\varphi(z_{i}) - \overline{\varphi(z_{j})}}{z_{i} - \overline{z_{j}}}\right]_{i, j = 1}^{n}
	=
	\left[\frac{\varphi_{2}(\varphi_{1}(z_{i})) - \overline{\varphi_{2}(\varphi_{1}(z_{j}))}}{\varphi_{1}(z_{i}) - \overline{\varphi_{1}(z_{j})}}\right]_{i, j = 1}^{n}
	\circ
	\left[\frac{\varphi_{1}(z_{i}) - \overline{\varphi_{1}(z_{j})}}{z_{i} - \overline{z_{j}}}\right]_{i, j = 1}^{n}.
\end{align*}

There's however more subtle connection, one between Schur transform and, rather appropriately, Schur complement.

If $\psi$ is Schur function such that $\psi(0) = 0$, then, by the Schwarz lemma, also $\psi(z)/z$ is a Schur function. One may again translate this to Pick functions, and get an interesting corollary: if $\varphi$ is a Pick function such that $\varphi(i) = i$, then also
\begin{align*}
	\frac{\varphi(z) - z}{1 + z \varphi(z)}
\end{align*}
is a Pick function. Actually, this gives a bijection between Pick functions and Pick functions with $\varphi(i) = i \ldots$ almost: $z \mapsto -\frac{1}{z}$ would like to map to constant infinity.

We could form similar bijection for any pair $(z, w) \in \H_{+}^{2}$: Pick functions for which $\varphi(z) = w$.

The previous bijection translates nicely to Pick matrices. Take sequence of points $z_{1}, z_{2}, \ldots, z_{n} \in \H_{+} \setminus \{i\}$. Theorem \ref{pick-nevanlinna_theorem} for $\varphi$ and points $i, z_{1}, \ldots, z_{n}$ implies that the matrix
\begin{align*}
	\begin{bmatrix}
		[i, -i]_{\varphi} & [i, \overline{z_{1}}]_{\varphi} & \cdots & [i, \overline{z_{n}}]_{\varphi} \\
		[z_{1}, -i]_{\varphi} & [z_{1}, \overline{z_{1}}]_{\varphi} & \cdots & [z_{1}, \overline{z_{n}}]_{\varphi} \\
		\vdots & \vdots & \ddots & \vdots \\
		[z_{n}, -i]_{\varphi} & [z_{n}, \overline{z_{1}}]_{\varphi} & \cdots &  [z_{n}, \overline{z_{n}}]_{\varphi}
	\end{bmatrix}
\end{align*}
is positive. Since $[i, -i]_{\varphi} = 1$ is positive, taking Schur-complement with respect to upper-left corner this is equivalent to the matrix
\begin{align*}
	& \left([z_{i}, \overline{z_{j}}]_{\varphi} - [z_{i}, -i]_{\varphi}[i, \overline{z_{j}}]_{\varphi}\right)_{1 \leq i, j \leq n} \\
	=& \left(\left(\frac{\varphi(z_{i})- \overline{\varphi(z_{j})}}{z_{i} - \overline{z_{j}}}\right) - \left(\frac{\varphi(z_{i}) + i}{z_{i} + i}\right)\left(\frac{i - \overline{\varphi(z_{j})}}{i - \overline{z_{j}}}\right)\right)_{1 \leq i, j \leq n} \\
	=& \left(\frac{[z_{i}, \overline{z_{j}}]_{\varphi} (z_{i} \overline{z_{j}} + 1) - 1 - \varphi(z_{i}) \overline{\varphi(z_{j})}}{(z_{i} + i) (\overline{z_{j}} - i)}\right)_{1 \leq i, j \leq n}
\end{align*}
being positive. But if one applies the theorem to the function $\frac{\varphi(z) - z}{1 + z \varphi(z)}$ and points $z_{1}, z_{2}, \ldots, z_{n}$, one arrives at the matrix
\begin{align*}
	\left(\frac{[z_{i}, \overline{z_{j}}]_{\varphi} (z_{i} \overline{z_{j}} + 1) - 1 - \varphi(z_{i}) \overline{\varphi(z_{j})}}{(1 + z_{i} \varphi(z_{i}))(1 + \overline{z_{j}} \overline{\varphi(z_{j})})}\right)_{1 \leq i, j \leq n}.
\end{align*}
Two resulting matrices are evidently congruent.

This line of thinking leads to alternate proof for the Pick-Nevanlinna interpolation theorem for finite domain $A$.

\begin{proof}[Alternate proof of \ref{pick_nevanlinna_interpolation} for finite $A$]
	We proceed by induction. Without loss of generality we may assume that $z_{1} = i = w_{1}$. We just noted that this matrix being positive is equivalent to smaller matrix, namely
	\[
		\left(\frac{\frac{w_{i} - z_{i}}{1 + z_{i} w_{i}} - \frac{\overline{w_{i}} - \overline{z_{i}}}{1 + \overline{z_{i}} \overline{w_{i}}}}{z_{i} - \overline{z_{j}}}\right)_{2 \leq i, j \leq n}
	\]
	being positive. By inductive hypothesis this then means that there exists a Pick function $\tilde{\varphi}$ with $\tilde{\varphi}(z_{i}) = \frac{w_{i} - z_{i}}{1 + z_{i} w_{i}}$. But then $\varphi(z) = \frac{\tilde{\varphi}(z) + z}{1 - z \tilde{\varphi}(z)}$ fits the bill.
\end{proof}

\section{Compactness}

One can lift the previous argument of the Pick-Nevanlinna interpolation theorem to infinite sets by the following compactness result.

\begin{lause}\label{pick_compactness}
	Let $F = \{\varphi_{j} | j \in J \}$ be a family of Pick functions uniformly bounded in a point. Then $F$ is compact under the topology of pointwise convergence.
\end{lause}
\begin{proof}
	Note that respective claim holds for Schur functions by Montel's theorem, so hence also holds for Pick functions $\ldots$ with one small caveat: the Schur function constant $-1$ corresponds to constant $\infty$, which isn't proper Pick function. But by the boundedness condition this is not a problem.
\end{proof}

There's really nothing special about Pick functions here: in the same way one could prove any family of analytic maps with common (non-whole-of-$\C$) simply connected codomain is compact. Of course we even get locally uniform convergence but that won't be important for us.

One could also give ``weaker" proof.

\begin{proof}[Alternate proof for the theorem \ref{pick_compactness}]
	Fix sequence in $F$. By lemma \ref{pick_continuity_lemma} and the condition values $\sup_{z \in K}|\varphi_{j}(z)|$ are uniformly bounded for every compact set $K$. The proof of the lemma also easily implies that $\varphi_{j}$'s are uniformly Lipschitz on compact sets. By Arzel\`{a}-Ascoli theorem for every compact set $K$ we can find a subsequence convergent in $K$ and exhausting upper half-plane by sequence of nested compact sets and taking the diagonal sequence we get the claim. By proposition \ref{pick_convergence} the limit is also Pick function.
\end{proof}

Of course, one could use Arzel\`{a}-Ascoli to prove the Montel's theorem in the first place, but the idea is that we can also forget the analyticity and work with Pick matrices on the weak level.

\section{Pick-Nevanlinna-Herglotz representation theorem}

One cannot simply talk about Pick functions without discussing Pick-Nevanlinna-Herglotz representation theorem.\footnote{TODO: (other names) Schwarz integral formula, Poisson formula}

Where does such representation come from? The representation \ref{pick_representation} tells us that every Pick function is essentially a sum functions of the form $\frac{1}{\lambda - z}$ (and an affine term). If $\varphi$ is bounded and extends over the real axis, this looks almost like Cauchy's integral formula but the beauty is that $\mu$ is real, while with Cauchy's integral formula we can't control the phase. TODO

\begin{comment}
We have however almost discussed such identities already. We for instance observed that
\begin{align*}
	& \frac{1}{2 \pi}\int_{-\infty}^{\infty} \frac{\Im\left(\varphi(z)\right)}{(z - a) (z - \overline{a})} dz \\
	=& \Re\left(\frac{1}{2 \pi i}\int_{-\infty}^{\infty} \frac{\varphi(z)}{(z - a) (z - \overline{a})} dz\right) \\
	=& \frac{\varphi(a) - \overline{\varphi(a)}}{a - \overline{a}} \\
	=& \Im\left(\frac{\varphi(a)}{a}\right)
\end{align*}
\end{comment}

\begin{lause}[Supplement to theorem \ref{pick_nevanlinna_herglotz_representation_theorem}]
	In the representation \ref{pick_representation} we have
	$\alpha = \lim_{y \to \infty} \frac{\varphi(i y)}{y}$, $\beta = \Re(\varphi(i))$ and we can recover the measure $\mu$ as
	\begin{align}\label{measure_recovery}
		\mu([a, b]) = \frac{1}{\pi}\lim_{x \to 0^{+}} \lim_{y \to 0^{+}} \int_{a - x + i y}^{b + x + i y} \Im(\varphi(z)) d z.
	\end{align}
\end{lause}

\begin{proof}
TODO
\end{proof}

We prove the statement in the chapter TODO. (Intuition on deforming contour, split the function to three pieces)

The integral representation makes many of the properties of the Pick functions obvious. TODO

\section{Examples of representing measures}

\section{Notes and references}

TODO:
\begin{itemize}
	\item Poincaré metric: discs are discs, Apollonius circle
	\item Examples of representing measures behind functions and functions behind representing measures
	\item Spectral commutant lifting theorem
	\item Use Morera's theorem to prove weak Hindmarsh's theorem
	\item Nice formula for finite Pick extension (rational function case)
\end{itemize}


How to rewrite majority of this section:
\begin{itemize}
	\item Concentrate on Pick-integrals
	\item Proof open Pick interpolation by extending thinking about Pick-integrals and then showing that the extension is unique, thus showing that everything works.
	\item Split the Pick measure weakly with $1/(x^2 + 1)$ (How to do the same thing with $k$-tone functions?)
\end{itemize}

