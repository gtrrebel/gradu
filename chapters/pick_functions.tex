\chapter{Pick--Nevanlinna functions}

\textit{Pick--Nevanlinna function} is an analytic function defined in upper half-plane with a non-negative imaginary part. Such functions are sometimes also called Herglotz or $\R$ functions; we will call them just \textit{Pick functions}. The class of Pick functions is denoted by $\pickclass$.

\section{Examples and basic properties}

Most obvious examples of Pick functions might be functions of the form $\alpha z + \beta$ where $\alpha, \beta \in \R$ and $\alpha \geq 0$. Of course one could also take $\beta \in \Hpc$. As non-constant analytic functions are open mappings, real constants are the only Pick functions failing to map $\Hp \to \Hp$.

Pick functions can be thought of a set of ``positive analytic functions".

\begin{lause}
	$\pickclass \subset \{\text{analytic maps on $\Hp$} \}$ is a closed convex cone.
\end{lause}
\begin{proof}
	Again, t.f.i.f \ref{positive_machine}.
\end{proof}

Composition of Pick functions (whenever defined) is a Pick function.

The map $z \mapsto -z^{-1}$ is evidently a Pick function. Hence are also all functions of the form
\begin{align*}
	\alpha z + \beta + \sum_{i = 1}^{N} \frac{m_{i}}{\lambda_{i}- z},
\end{align*}
where $N$ is non-negative integer, $\alpha, m_{1}, m_{2}, \ldots, m_{N} \geq 0$, $\beta \in \Hp$ and $\lambda_{1}, \ldots, \lambda_{N} \in \Hm$.

There are (luckily) more interesting examples. All the functions of the form $z \mapsto z^{p}$ where $0 < p < 1$ (with natural branch) are Pick functions; similarly for $\log$. Another classic example is $\tan$. Indeed, by the addition formula
\begin{eqnarray*}
	\tan(x + i y) &=& \frac{\tan(x) + \tan(i y)}{1 - \tan(x) \tan(i y)} = \frac{\tan(x) + i \tanh(y)}{1 - i \tan(x) \tanh(y)} \\
	&=& \frac{\tan(x)(1 + \tanh^2(y))}{1 + \tan^2(x) \tanh^2(y)} + i \frac{(1 + \tan^2(x))\tanh(y)}{1 + \tan^2(x) \tanh^2(y)},
\end{eqnarray*}
and $y$ and $\tanh(y)$ have the same sign.

$\pickclass$ is almost salient: if $\varphi$ is analytic and $\Im(\varphi) = 0$, then $\varphi$ is a real constant (by Cauchy-Riemann equations, for instance). And again, this suggests that one should think about Pick functions up to a real constant.

So far we have made no mention on the topology, as it's usually taken to be the topology of locally uniform convergence. This definitely works (as it makes the evaluation functionals continuous), but we can do much better. It namely turns out that we can consider the set of Pick functions as a proper cone of $\C^{\Hp}$, set of all complex functions on $\Hp$ with the product topology (i.e. the topology of pointwise convergence).

\begin{prop}\label{pick_convergence}
	If $(\varphi_{i})_{i = 1}^{\infty}$ is a sequence of Pick functions converging pointwise, the limit function is also a Pick function.
\end{prop}

This result is far from clear: pointwise limits of analytic functions need not analytic in general (see for instance TODO). We will not prove the result yet, but it strongly suggests that there is something more going on; Pick functions are very rigid. Note also that if Pick functions are thought as a subset of $\C^{\Hp}$, the definition of the cone doesn't fit the general framework of Theorem \ref{positive_machine}. This suggests that question one should ask is:

\begin{quest}\label{pick_predual}
	What is the ``correct" predual for $\pickclass$?
\end{quest}


\section{Rigidity}

\subsection{Boundary}

To understand the rigidity phenomena we take a brief look at a close relative of Pick functions, \textit{Schur functions}. Schur funtions are analytic maps from open unit disc to closed unit disc. Classic fact about these functions is the Schwarz lemma.

\begin{lause}[Schwarz lemma]
	Let $\psi : \D \to \D$ be analytic such that $\psi(0) = 0$. Then $|\psi(z)| \leq |z|$ for any $z \in \D$.
\end{lause}

The textbook proof is based on two observations about analytic functions.
\begin{itemize}
	\item If $\varphi$ is analytic at $a$ with $\varphi(a) = 0$, then $\varphi/(\cdot - a)$ is also analytic.
	\item If $\varphi$ is analytic on closed unit disc and $|\varphi| \leq 1$ on the boundary of the disc, then $|\varphi| \leq 1$ inside the disc.
\end{itemize}

The first observation might not be very surprising, and it holds for smooth functions also. The second, on the other hand, is a true manifestation of the nature of the analytic maps: we can bound analytic functions simply by bounding them on the boundary of the domain. More generally: one knows everything about an analytic function on a domain simply by knowing it on a boundary, by Cauchy's integral formula.

This suggests that we should be able to recognize also Pick functions looking only at their boundary values. Actually even more is true: it suffices to look at the imaginary parts.

\begin{prop}
	Let $U \supset \overline{\Hp}$ and $\varphi : U \to \C$ analytic, and $\varphi$ is continuous at $\infty$. Then if the imaginary part of $\varphi$ is non-negative on the real axis, $\varphi$ is Pick function.
\end{prop}
\begin{proof}
	t.f.i.f the minimum principle applied to the harmonic function $\Im(\varphi)$.
\end{proof}

\subsection{Integral representations}

Recall that imaginary part of an analytic function determines also its real part, up to a constant, so we can also recover the function itself. This can be also done explicitly.

\begin{lause}
	Let $U \supset \overline{\Hp}$ and $\varphi : U \to \C$ analytic such that $\varphi(z) = O(|z|^{-\varepsilon})$ for some $\varepsilon > 0$ at infinity. Then for any $z \in \Hp$ we have
	\begin{align*}
		\varphi(z) = \frac{1}{\pi}\int_{\R} \frac{\Im(\varphi)(\lambda)}{\lambda - z} d \lambda
	\end{align*}
\end{lause}
\begin{proof}
	Note that the integral defines an analytic function, imaginary part of which equals
	\begin{align*}
		\frac{\Im(z)}{\pi}\int_{\R} \frac{\Im(\varphi)(\lambda)}{(\lambda - z)(\lambda - \overline{z})} d \lambda.
	\end{align*}
	This expression however equals $\Im(\varphi(z))$ by Poisson integral formula. By letting $z \to \infty$ one sees that also the real constants match.

	Alternatively one could observe that for a closed counter clockwise oriented curves $\gamma$ on the upper half-plane, enclosing $z$, we have
	\begin{align*}
		\varphi(z) = \frac{1}{2\pi i}\int_{\gamma} \frac{\varphi(\lambda)}{\lambda - z} d \lambda.
	\end{align*}
	Now given the bound, we may deform the contour to real axis. By comparing this identity and our goal, we are left to prove that
	\begin{align*}
		\frac{1}{2\pi i}\int_{\gamma} \frac{\overline{\varphi(\lambda)}}{\lambda - z} d \lambda = \frac{1}{2\pi i} \overline{\int_{\gamma} \frac{\varphi(\lambda)}{\lambda - \overline{z}} d \lambda} = 0.
	\end{align*}
	But this is clear as $\varphi/(\cdot - \overline{z})$ is analytic in the upper half-plane.
\end{proof}

There's of course nothing really special about the decay assumption $\varphi(z) = O(|z|^{-\varepsilon})$; it's there just to make everything converge.

One can guarantee the convergence also by other means. Consider the integral
\begin{align}\label{easy_pick_repr}
	\frac{1}{\pi}\int_{\R} \left(\frac{1}{\lambda - z} - \frac{[|\lambda| > 1]}{\lambda} \right) \Im(\varphi)(\lambda)d \lambda.
\end{align}
It converges to an analytic function as long as, say, $\Im(\varphi)$ is bounded. As before, its imaginary part coincides with $\varphi$'s so the functions are equal up to a real constant. Now, however, there's no reason for the real constants to match and indeed they need not. Of course there's nothing really special about $[|\lambda| > 1]\lambda^{-1}$: it is just constant in $z$ and has convenient asymptotics at $\infty$.

Note that the previous idea could be used to construct Pick functions. Everything still makes sense if we replace $\Im(\varphi)$ by some other positive function, as long as the integral converges. Heck, we could replace it by any positive measure for which $\mu((\lambda^2 + 1)^{-1}) < \infty$.

(Almost) all the examples given before are actually just special cases of this construction. The rational functions $(\lambda - z)^{-1}$, where $\lambda \in \R$ are obtained by setting $\mu = \delta_{\lambda}$. The power functions are obtained as
\begin{align*}
	z^{p} &= 1 + \frac{1}{\pi}\int_{-\infty}^{0} \left(\frac{1}{\lambda - z} - \frac{1}{\lambda - 1}\right) \Im(\lambda^{p}) d \lambda \\
	&=1 + \frac{1}{\pi}\int_{-\infty}^{0} \left(\frac{1}{\lambda - z} - \frac{1}{\lambda - 1}\right) |\lambda|^{p} \sin(\pi p) d \lambda,
\end{align*}
Logarithm is even simpler:
\begin{align*}
	\log(z) = \int_{-\infty}^{0} \left(\frac{1}{\lambda - z} - \frac{1}{\lambda - 1}\right) d \lambda.
\end{align*}
Tangent function could be obtained by putting $\delta$-measures to its poles, the points of the form $\pi/2 + n \pi$, where $n \in \Z$.

The only exception is the function $z \mapsto \alpha z$ -- it can't be expressed as such integral. But even this failure is really more about poor point of view, as we will see in a minute. With these observations in mind it ought to be not too surprising that we have the following.

\begin{lause}\label{pick_nevanlinna_herglotz_representation_theorem}
	$\varphi \in \pickclass$, if and only
	\begin{align}\label{pick_representation}
		\varphi(z) = \alpha z + \beta + \int_{-\infty}^{\infty} \left(\frac{1}{\lambda - z} - \frac{\lambda}{\lambda^2 + 1}\right) d \mu(\lambda)
	\end{align}
	for some $\alpha \geq 0$ and $\beta \in \R$ and a Radon measure $\mu$ with $\int_{-\infty}^{\infty} (\lambda^2 + 1)^{-1} d \mu(\lambda) < \infty$.
\end{lause}

Choosing $\lambda \mapsto \lambda/(\lambda^2 + 1)$ to ensure convergence is common choice in the literature, and is convenient as
\begin{itemize}
	\item It's real, so the integrand is Pick function for any $\lambda \in \R$.
	\item We may recover the constant $\beta$ as $\Re(\varphi(i))$.
\end{itemize}

To better explain the appearance of the linear term, we can write the integral in a sligtly different form. Denoting $d \nu(\lambda) = (\lambda^2 + 1)^{-1} d \mu(\lambda)$, the formula reads
\begin{align*}
	\varphi(z) = \alpha z + \beta + \int_{-\infty}^{\infty} \frac{\lambda z + 1}{\lambda - z} d \nu(\lambda).
\end{align*}
Here $\nu$ is just a finite Borel measure. Now it kind of makes sense to extend the domain of this measure to infinity: the linear term merely corresponds to $\delta$-measure at the infinity point. Of course, should one formalize this line of thought, the question on the type of extended real line had to be asked and one should address the topology. The answer is that one should glue the real line into a circle. One shouldn't worry about such issues, though, as these thoughts are merely for intuition. The giveaway is that $\alpha$ should be really thought as a part of the measure $\mu$, even though this might not make perfect sense.

We will not prove theorem \ref{pick_nevanlinna_herglotz_representation_theorem}, but it shall work as a motivation.

\section{Dual thinking}

\subsection{Search for a predual}

Let's return to Question \ref{pick_predual}: our goal is to find some set of linear functionals on $\C^{\Hp}$, i.e. a subset of $(\C^{\Hp})^{*}$, such that $\pickclass$ is dual cone of $C^{*}$. Recall that most of the cones of past chapters were defined directly via some predual:

\begin{itemize}
	\item $\H_{+}(V)$, the cone of positive maps, was defined as the dual cone of quadratic functionals: maps of the form $A \mapsto \langle A v, v \rangle$ for $v \in V$.
	\item $P^{(k)}(a, b)$, the cone of $k$-tone functions (on $(a, b)$), was defined as the dual cone of order $k$ divided differences: maps of the form $f \mapsto [x_{0}, x_{1}, \ldots, x_{k}]_{f}$, where $a < x_{0}, x_{1}, \ldots, x_{k} < b$ are pairwise distinct.
	\item $P_{n}(a, b)$, the cone of $n$-monotone functions (on $(a, b)$), was defined as the dual cone of maps of the form $f \mapsto \langle (f(B) - f(A)) v, v \rangle$, were $v \in V$ and $A, B \in \H_{(a, b)}$ are such that $A \leq B$.
\end{itemize}

In chapter $5$ we managed to find some kind of answers to Questions \ref{question_1} and \ref{question_2}: we gave simpler preduals for $P_{n}(a, b)$ and $P_{\infty}(a, b)$:

\begin{itemize}
	\item The functionals of the form $f \mapsto [x_{0}, x_{1}, \ldots, x_{2 n - 1}]_{f N(q)}$ (for pairwise distinct $a < x_{0}, x_{1}, \ldots, x_{2 n - 1} < b$ and $q \in \C_{n - 1}[x]$) form a predual for $P_{n}(a, b)$.
	\item The functionals of the form $f \mapsto \langle f, r \rangle_{L}$ (for $r \in R_{+}(a, b)$) form a predual for $P_{\infty}(a, b)$.
\end{itemize}

Now we have an inverse problem: we have set of functions (Pick functions) and would like to find such a predual. Moreover, we would like to interpret $\pickclass$ as a subset $\C^{\Hp}$ with product topology, i.e. the topology of pointwise convergence. Note that if we find such predual (let's denote it by $C^{*}$ for a short while), we get Proposition \ref{pick_convergence} for free.

\begin{proof}[Proof of Proposition \ref{pick_convergence} (given the existence of $C^{*}$)]
	By the extra assumption we have $C^{*} \subset (\C^{\Hp})^{*}$, a set of linear functionals such that
	\begin{align*}
		\varphi &\in \pickclass \\
		&\Leftrightarrow \\
		p^{*}(\varphi) \geq 0 &\text{ for any $p^{*} \in C^{*}$}.
	\end{align*}
	Take a sequence $(\varphi_{i})_{i = 1}^{\infty}$ of Pick functions converging poinwise to $\varphi_{\infty}$, and take any $p^{*} \in C^{*}$. Since $p^{*}$ is continuous, and $C^{*}$ is a predual of $\pickclass$, we have
	\begin{align*}
		p^{*}(\varphi_{\infty}) = \lim_{i \to \infty} p^{*}(\varphi_{i}) \geq 0.
	\end{align*}
	But this means that $\varphi_{\infty}$ lies in the dual cone of $C^{*}$, i.e. in $\pickclass$, as desired.
\end{proof}

Of course, one can show Proposition \ref{pick_convergence} by many other means, but as we will see later on, the predual $C^{*}$ itself is the true reward for our troubles.

So, how is one to find $C^{*}$? We are going to perform our search via the following steps:

\begin{enumerate}[\textbf{Step} 1.]
	\item Which functionals $p^{*} \in (\C^{\Hp})^{*}$ satisfy
	\begin{align*}
		p^{*}(\varphi) \geq 0
	\end{align*}
	for any $\varphi \in \pickclass$? Note that $C^{*}$ should be definitely subset of such functionals. But then again, we don't really lose anything if we pick all such functionals to $C^{*}$. So if there is such $C^{*}$, we could (and will) set
	\begin{align*}
		C^{*} := \{p^{*} \in (\C^{\Hp})^{*} | p^{*}(\varphi) \geq 0 \text{ for every $\varphi \in \pickclass$}\}.
	\end{align*}
	Note that this (potential) predual is maximal in some sense: it is a union of all possible preduals for $\pickclass$; so it actually makes sense to talk about \textbf{the} predual.
	\item Now that we have found potential predual $C^{*}$, is $\pickclass$ really its dual cone? Note that by the definition of $C^{*}$, all Pick functions are contained in its dual cone. But it might a priori contain more functions! So we should check that every element in $\C^{\Hp}$ which gives non-negative values on every functional on $C^{*}$
	\begin{enumerate}[(i)]
		\item maps upper half-plane to its closure and
		\item is analytic.
	\end{enumerate}
\end{enumerate}

\begin{comment}
To further highlight the step $3$, let's return to the realm of $k$-tone functions for a while. Recall that we set out to define $k$-tone functions as a set of functions that are more or less functions with non-negative $k$'th derivative. So, why not just define them as the set of functions with non-negative $k$'th derivative? The problem is that such functions are rather fragile. They are, for instance, not closed under pointwise convergence. Now, one could try to run the above steps for such functions. Let's say we are investigating $k$-tone functions on $(a, b)$. At step $1$ one would observe that one should think about $(\R^{(a, b)})^{*}$ as some kind of piecewise polynomial functions. At step $2$ one could choose non-negative such functions as $C^{*}$. Or some subset of them: we chose Peano kernels. But at step $3$ there's a problem: we get more functions.
\end{comment}

\subsection{Step 1}\label{step_1}

First off: how should one even interpret $(\C^{\Hp})^{*}$? Should $\C^{\Hp}$ be a vector space over $\C$, or maybe over $\R$? The correct answer is neither.

Let us first look at $\C$-linear functionals $\C^{\Hp} \to \C$. It is a general fact that continuous dual of a product consists of functionals of finite support, i.e. it is the direct sum of the duals of the factors (see for instance TODO)\footnote{This fact is not important to us and we could have restricted our attention to finitely supported functionals anyway.}.

This is all just to say that $\C$-linear functionals on $\C^{\Hp}$ are of the form
\begin{align*}
	\varphi \mapsto \sum_{i = 1}^{m} c_{i} \varphi(z_{i}),
\end{align*}
where $m \geq 0$, $c_{1}, c_{2}, \ldots, c_{m} \in \C$ and $z_{1}, z_{2}, \ldots, z_{m} \in \Hp$. So the question is: for which tuples $c_{i}$'s and $z_{i}$'s is such sum non-negative real number for any Pick function $\varphi$?

This is where the integral representations of the previous sections come in. If one is to believe in \ref{pick_nevanlinna_herglotz_representation_theorem}, for any Pick function $\varphi$ we have
\begin{align*}
	\sum_{i = 1}^{m} c_{i} \varphi(z_{i}) &= \sum_{i = 1}^{m} c_{i} \left(\alpha z_{i} + \beta + \int_{-\infty}^{\infty} \left(\frac{1}{\lambda - z_{i}} - \frac{\lambda}{\lambda^2 + 1}\right) d \mu(\lambda)\right) \\
	&= \alpha \sum_{i = 1}^{m} c_{i} z_{i} + \beta \sum_{i = 1}^{m} c_{i} + \int_{-\infty}^{\infty} \left( \sum_{i = 1}^{m}\frac{c_{i}}{\lambda - z_{i}} - \frac{\lambda}{\lambda^2 + 1} \sum_{i = 1}^{m} c_{i} \right) d \mu(\lambda)
\end{align*}
Since $\beta$ can be any real, we should have $\sum_{i = 1}^{m} c_{i} = 0$. Choosing $\lambda \in \R$, $\mu = \delta_{\lambda}$, $\alpha = 0$, we see that
\begin{align*}
	r(\lambda) := \sum_{i = 1}^{m}\frac{c_{i}}{\lambda - z_{i}}
\end{align*}
should be non-negative for any $\lambda \in \R$. Consequently: $r$ is a rational function, real on reals, so its poles lie symmetrically with respect to real axis. But since all poles of $r$ lie in $\Hp$, this means that $r$ is zero, and hence all $c_{i}$'s are zeroes. So there are no non-trivial $\C$-linear functionals on $\C^{\Hp}$, non-negative on Pick functions.

What about real functionals? It's easy to see that all $\R$-linear functionals $\C^{\Hp} \to \R$ are given by real parts of complex functionals. So again, pick $m \geq 0$, $c_{1}, c_{2}, \ldots, c_{m} \in \C$ and $z_{1}, z_{2}, \ldots, z_{m} \in \Hp$ and consider linear functional of the form
\begin{align*}
	\varphi \mapsto \sum_{i = 1}^{m} \Re\left(c_{i} \varphi(z_{i})\right).
\end{align*}
If $\varphi$ is a Pick function, we have, as in the complex case,
\begin{align*}
	\sum_{i = 1}^{m} \Re(c_{i} \varphi(z_{i})) &= \alpha \sum_{i = 1}^{m} \Re(c_{i} z_{i}) + \beta \sum_{i = 1}^{m} \Re(c_{i}) + \int_{-\infty}^{\infty} \Re\left( \sum_{i = 1}^{m}\frac{c_{i}}{\lambda - z_{i}} - \frac{\lambda}{\lambda^2 + 1} \sum_{i = 1}^{m} c_{i} \right) d \mu(\lambda) \\
	&= \frac{\alpha}{2} \sum_{i = 1}^{m} \left(c_{i} z_{i} + \overline{c_{i}} \overline{z_{i}}\right) + \frac{1}{2}\int_{-\infty}^{\infty} \left( \sum_{i = 1}^{m} \left(\frac{c_{i}}{\lambda - z_{i}} + \frac{\overline{c_{i}}}{\lambda - \overline{z_{i}}}\right)\right) d \mu(\lambda).
\end{align*}
In particular the rational function
\begin{align*}
	r(\lambda) := \sum_{i = 1}^{m} \left(\frac{c_{i}}{\lambda - z_{i}} + \frac{\overline{c_{i}}}{\lambda - \overline{z_{i}}}\right)
\end{align*}
should be non-negative.

These considerations suggest that elements of $C^{*}$ should correspond to non-negative rational functions, whereas elements of $(\C^{\Hp})^{*}$ should be rational functions mapping reals to reals. One could work with such functionals, but it is convenient to broaden one's view slightly: we will also consider complex rational functions. We will specifically study the following family of rational functions.

\begin{maar}
	Let $X \subset \C$. We will denote by $R(X)$ the $\C$-vector space of rational functions $r$ such that:
	\begin{itemize}
		\item $r$ vanishes at infinity.
		\item All poles of $r$ lie in $X$.
		\item All poles of $r$ are simple.
	\end{itemize}
	We will also write $R_{+}(X)/R_{\pm}(X)$ for the functions in $R(X)$, which are non-negative/real on $\R$.
\end{maar}

We will be mostly interested in the case $X = \Hp \cup \Hm$, but for future convenience we will also study other sets. Note that the set $R(\Hp \cup \Hm)$ generalizes the rational functions in both the complex and real settings.

Let us first make couple of reality checks concering the sets $R(X)$, $R_{\pm}(X)$ and $R_{+}(X)$. For a rational function $r$, denote by $r^{*}$ the rational function for which
\begin{align*}
	r^{*}(\lambda) = \overline{r(\overline{\lambda})}
\end{align*}
for any $\lambda \in \C$. Denote also
\begin{align*}
	X^{*} = \{z \in \C | \overline{z} \in X \}
\end{align*}
whenever $X \subset \C$.

\begin{prop}\label{pick_functional_span}
	\begin{enumerate}[(i)]
		\item
		\begin{align*}
			R(X) = \vspan_{\C} \left\{\frac{1}{\cdot - z} | z \in X \right\}.
		\end{align*}
		\item
		\begin{align*}
			R_{\pm}(X) &= \vspan_{\R} \left\{\frac{c}{\cdot - z} + \frac{\overline{c}}{\cdot - \overline{z}} | c \in \C, z \in X \cap X^{*} \right\} \\
			&= \{r + r^{*} | r \in R(X \cap X^{*}) \} = \{r \in R(X) | r = r^{*}\}.
		\end{align*}
		\item
		\begin{align*}
			R_{+}(X) = \left\{ N(r) | r \in R(X \cap X^{*} \cap \Hp) \right\}.
		\end{align*}
		\item
		\begin{align*}
			\vspan_{\C} R_{\pm}(X) = R(X \cap X^{*})
		\end{align*}
		\item
		\begin{align*}
			\vspan_{\R} R_{+}(X) = \{r \in R_{\pm}(X) | r(\lambda) = O(\lambda^{-2}) \text{ at }\infty\}
		\end{align*}
		\item
		\begin{align*}
			\vspan_{\C} R_{+}(X) = \{r \in R(X \cap X^{*}) | r(\lambda) = O(\lambda^{-2}) \text{ at }\infty\}
		\end{align*}
	\end{enumerate}
\end{prop}
\begin{proof}
	\begin{enumerate}[(i)]
		\item This is just the partial fraction decomposition.
		\item Easy to check.
		\item This follows from \ref{polynomial_lemma}.
		\item Easy to check.
		\item It is easy to check that elements of the right-hand side are spanned by the functions of the form
		\begin{align*}
			&\frac{c}{(\cdot - z)(\cdot - \overline{w})} + \frac{\overline{c}}{(\cdot - \overline{z})(\cdot - w)} \\
			=& N\left(\frac{c}{\cdot - z} + \frac{1}{\cdot - w}\right) - |c|^2 N\left(\frac{1}{\cdot - z}\right) - N\left(\frac{1}{\cdot - w}\right) \in \vspan_{\R} R_{+}(X).
		\end{align*}
		\item Follows easily from the previous part.
	\end{enumerate}
\end{proof}

How do the elements of $R(\Hp \cup \Hm)$ define linear functionals on $\C^{\Hp}$? Given any $r \in R(\Hp \cup \Hm)$, write it in the form $r = \sum_{i = 1}^{m} c_{i} (\cdot - z_{i})^{-1}$, where $m \geq 0$, $c_{1}, c_{2}, \ldots, c_{m} \in \C$ and $z_{1}, z_{2}, \ldots, z_{m} \in \Hp \cup \Hm$. Then, if we are given any $\varphi \in \C^{\Hp}$, we set
\begin{align*}
	\varphi \mapsto \sum_{i = 1}^{m} c_{i} \varphi(z_{i}).
\end{align*}
Except now there's a slight problem: if $z_{i} \in \Hm$, $\varphi(z_{i})$ is not defined! For Pick functions such rational functions correponded to conjugated evaluations, so we could of course interpret the above definition with the following abuse:
\begin{align}\label{abuse}
	\varphi(\overline{z}) = \overline{\varphi(z)},
\end{align}
for any $z \in \Hp$. Instead, we do something else. Every function in $\C^{\Hp}$ can be interpreted as a function in $\C^{\Hp \cup \Hm}$, extending with \ref{abuse}. In this way every element of $R(\Hp \cup \Hm)$ corresponds to a $\C$-linear functional $\C^{\Hp \cup \Hm} \to \C$. It is easy to see that every such functional also corresponds to an element in $R(\Hp \cup \Hm)$. We hence have an dual pairing between $\C^{\Hp \cup \Hm}$ and $R(\Hp \cup \Hm)$, $\C$-linear in both arguments, denoted by $\langle \cdot, \cdot \rangle_{L}$.

To recap $\langle \cdot, \cdot \rangle_{L} : \C^{\Hp \cup \Hm} \times R(\Hp \cup \Hm) \to \C$ is the unique $\C$-bilinear mapping for which
\begin{align*}
	\langle \varphi, (\cdot - z)^{-1}\rangle_{L} = \varphi(z)
\end{align*}
for any $\varphi \in \C^{\Hp \cup \Hm}$ and $z \in \Hp \cup \Hm$. Note also that for fixed $r \in R(\Hp \cup \Hm)$, the map $\varphi \mapsto \langle \varphi, r\rangle_{L}$ is continuous. We could of course build similar pairing for any $X \subset \C$. This pairing is essentially the same as the one we defined in section \ref{dual_pairing_section}.

So finally: which elements in $r \in R(\Hp \cup \Hm)$ are such that
\begin{align*}
	\langle \varphi, r \rangle_{L} \geq 0
\end{align*}
for any Pick function $\varphi$? One could use Theorem \ref{pick_nevanlinna_herglotz_representation_theorem} to prove that these functionals are exactly the elements of $R_{+}(\Hp \cup \Hm)$, but as we haven't proven Theorem \ref{pick_nevanlinna_herglotz_representation_theorem}, we will give an alternate argument.

\begin{lause}\label{pick_functionals}
	Let $r \in R(\Hp \cup \Hm)$. Now
	\begin{align*}
		\langle \varphi, r \rangle_{L} \geq 0
	\end{align*}
	for any $\varphi \in \pickclass$, if and only if $r \in R_{+}(\Hp \cup \Hm)$.
\end{lause}
\begin{proof}
	Note that $\varphi_{\lambda} := (\lambda - \cdot)^{-1} \in \pickclass$, and
	\begin{align*}
		\langle \varphi_{\lambda}, r \rangle_{L} = r(\lambda)
	\end{align*}
	for any $\lambda \in \R$ and $r \in R(\Hp \cup \Hm)$. We must hence have $r \in R_{+}(\Hp \cup \Hm)$.

	Conversely, fix any $r \in R_{+}(\Hp \cup \Hm)$. We already know that $\langle \varphi_{\lambda}, r\rangle \geq 0$ for any $\lambda \in \R$ so by continuity it suffices to prove the following result.

	\begin{lem}\label{pick_dense}
		Under the topology of pointwise convergence one has
		\begin{align*}
			\pickclass \subset \overline{\cone}\{\varphi_{\lambda} | \lambda \in \R\} \left(\subset \C^{\Hp} \subset \C^{\Hp \cup \Hm}\right).
		\end{align*}
	\end{lem}
	\begin{proof}
		Denote the closure of the cone by $\pickclass_{e}$. As $\lim_{\lambda \to \pm \infty}|\lambda|(\lambda - z)^{-1} = \pm 1$, $\pickclass_{e}$ contains real constants. Now by \ref{easy_pick_repr} all the bounded Pick functions extending analytically over $\R$ are also in $\pickclass_{e}$. We finish the proof by showing that such functions, denoted by $\pickclass_{b}$, are dense in the set of all Pick functions.

		It is straightforward to check that
		\begin{align*}
			g_{\varepsilon}(z) = \frac{z + i \varepsilon}{1 - i \varepsilon z} \in \pickclass_{b}
		\end{align*}
		for any $\varepsilon > 0$. But now for any $\varphi \in \pickclass$ and $\varepsilon > 0$ also $\varphi \circ g_{\varepsilon} \in \pickclass_{b}$. Finally $\varphi = \lim_{\varepsilon \to 0} \varphi \circ g_{\varepsilon} \in \pickclass_{b}$, as we wanted.
	\end{proof}
\end{proof}

We will call the maps $\varphi \mapsto \langle \varphi, r\rangle_{L}$ for fixed $r \in R_{+}(\Hp \cup \Hm)$ \textbf{Pick functionals}.

One can write the Pick functionals also in terms of divided differences. If $r \in R_{+}(\Hp \cup \Hm)$, we have
\begin{align*}
	r = \frac{N(q)}{|\cdot - z_{1}|^2 \cdots |\cdot - z_{n}|^2}
\end{align*}
for some $n \geq 1$, $q \in \C_{n - 1}[x]$ and pairwise distinct $z_{1}, z_{2}, \ldots, z_{n} \in X$. But this means that
\begin{align*}
	\langle \varphi, r\rangle_{L} = [z_{1}, \overline{z_{1}}, \ldots, z_{n}, \overline{z_{n}}]_{\varphi N(q)}.
\end{align*}

\subsection{Step 2}\label{step_2}

Recall that our aim is to prove that $\pickclass \in \C^{\Hp \cup \Hm}$ is the dual cone of $R_{+}(\Hp \cup \Hm)$ in the sense of $\langle \cdot, \cdot \rangle_{L}$. In other words: we should prove that if $\varphi \in \C^{\Hp \cup \Hm}$ is such that
\begin{align}\label{weakly_pick_def}
	\langle \varphi, r\rangle_{L} \geq 0 \text{ for any  $r \in R_{+}(\Hp \cup \Hm)$},
\end{align}
then $\varphi \in \pickclass$, i.e.
\begin{enumerate}[(i)]
	\item $\varphi(\overline{z}) = \overline{\varphi(z)}$ for any $z \in \Hp$,
	\item $\Im(\varphi(z)) \geq 0$ for any $z \in \Hp$,
	\item $\varphi$ is analytic on $\Hp$.
\end{enumerate}

Unfortunately this is not quite true. Since $\langle 1, r \rangle_{L} = 0$ for any $r \in R_{+}(\Hp \cup \Hm)$, $\varphi$ is characterized only up to a complex constant. Luckily this is the only problem: it is instead true that any function satisfying \ref{weakly_pick_def} differs from a Pick function by a constant. We will call a function $\varphi \in \C^{\Hp \cup \Hm}$ satisfying \ref{weakly_pick_def} \textbf{weakly Pick function}, and denote the set of weakly Pick functions by $\pickclass(\Hp \cup \Hm)$.

The proper replacement for (i) is the following lemma.

\begin{lem}\label{pick_predual_1}
	Let $\varphi \in \pickclass(\Hp \cup \Hm)$. Then for any $z, w \in \Hp$ one has
	\begin{align*}
		\varphi(\overline{z}) - \overline{\varphi(z)} = \varphi(\overline{w}) - \overline{\varphi(w)} \in i \R.
	\end{align*}
\end{lem}
\begin{proof}
	Observe that
	\begin{align*}
		\varphi(\overline{z}) - \overline{\varphi(z)} &= \varphi(\overline{z}) - \varphi(z) + \varphi(z) - \overline{\varphi(z)}\\
		&= \left\langle \varphi, \frac{1}{\cdot - \overline{z}} - \frac{1}{\cdot - z} \right\rangle_{L} + 2 i \Im(\varphi(z)) \\
		&= - 2 i \Im(z) \left\langle \varphi, \frac{1}{|\cdot - z|^2} \right\rangle_{L} + 2 i \Im(\varphi(z)).
	\end{align*}
	As $|\cdot - z|^{-2} \in R_{\pm}(\Hp \cup \Hm)$, we have $\varphi(\overline{z}) - \overline{\varphi(z)} \in i \R$ for any $z \in \Hp$.

	For the first equality the rough idea is the following: for any $c \in \C$ we have
	\begin{align*}
		r_{z, c} := \frac{c}{\cdot - z} + \frac{\overline{c}}{\cdot - \overline{z}} \in R_{\pm}(\Hp \cup \Hm).
	\end{align*}
	Now if that would imply that $\langle \varphi, r_{z, c} \rangle_{L} \in \R$, we would be done. Indeed, it is easy to see that for fixed $z \in \Hp$
	\begin{align*}
		\R \ni \langle \varphi, r_{z, c} \rangle_{L} = c \varphi(z) + \overline{c} \varphi(\overline{z})
	\end{align*}
	for any $c \in \C$, if and only if $\varphi(\overline{z}) = \overline{\varphi(z)}$.

	This doesn't quite work, since $r_{z, w} \notin \vspan_{\R} R_{+}(\Hp \cup \Hm)$, but if one performs the same trick with
	\begin{align*}
		\frac{c}{\cdot - z} + \frac{\overline{c}}{\cdot - \overline{z}} - \frac{c}{\cdot - w} + \frac{\overline{c}}{\cdot - \overline{w}},
	\end{align*}
	which lies in $\vspan_{\R}R_{+}(\Hp \cup \Hm)$, one gets the claim.
\end{proof}

By the previous lemma, any $\varphi \in \pickclass(\Hp \cup \Hm)$ can be translated to satisfy (i). We denote the set of such translates by $\pickclass(\Hp)$. Note that $\pickclass(\Hp)$ can be thought of as subset of $\C^{\Hp}$.

\begin{lem}
	Let $\varphi \in \pickclass(\Hp)$. Then $\Im(\varphi(z)) \geq 0$ for any $z \in \Hp$.
\end{lem}
\begin{proof}
	This follows immediately from the first computation of the proof of Lemma \ref{pick_predual_1}.
\end{proof}

The third property is trickier. Let us first try to prove something somewhat easier.

\begin{prop}
	Let $\varphi \in \pickclass(\Hp)$. Then $\varphi$ is continuous.
\end{prop}
\begin{proof}
	We should prove that for any $w \in \Hp$ we have
	\begin{align*}
		0 = \lim_{z \to w}\left(\varphi(z) - \varphi(w)\right) = \lim_{z \to w} \left\langle \varphi, \frac{1}{\cdot - z} - \frac{1}{\cdot - w}\right\rangle_{L}.
	\end{align*}
	The function $r_{z, w} := (\cdot - z)^{-1} - (\cdot - w)^{-1}$ tends to zero (in some sense) as $z \to w$, so something like this ought to be true: $R(\Hp \cup \Hm)$ should have topology for which this convergence happens and the map $r \mapsto \langle \varphi, r\rangle$ is continuous.

	And indeed, there is one: one induced by
	\begin{align*}
		\|r\|_{R} = \sup_{\lambda \in \R} |r(\lambda)| (\lambda^2 + 1).
	\end{align*}
	It should be noted that $\|\cdot\|_{R}$ is not norm, as it is infinite for some elements of $R(\Hp \cup \Hm)$. It nevertheless defines a topology and one straightforwardly checks that
	\begin{align*}
		&\{r \in R(\Hp \cup \Hm) | \|r\|_{R} < \infty\} \\
		=& \{r \in R(\Hp \cup \Hm) | \langle 1, r \rangle_{L} = 0 \} \\
		=& \vspan_{\C} R_{+}(\Hp \cup \Hm).
	\end{align*}

	\begin{lem}\label{pick_norm_estimate}
		For $\varphi \in \pickclass(\Hp)$ there exists a constant $C(\varphi)$ such that
		\begin{align*}
			\left|\langle \varphi, r \rangle_{L}\right| \leq C(\varphi) \|r\|_{R}
		\end{align*}
		for any $r \in R(\Hp \cup \Hm)$.
	\end{lem}
	\begin{proof}
		Note that the statement is trivially true if $\|r\|_{R} = \infty$. Write $r = r_{1} + i r_{2}$ where $r_{1}, r_{2} \in R_{\pm}(\Hp \cup \Hm)$. Since clearly
		\begin{align*}
			\|r\|_{R} \geq \max(\|r_{1}\|_{R}, \|r_{2}\|_{R}),
		\end{align*}
		it suffices cook up such estimate for $R_{\pm}(\Hp \cup \Hm)$. But such functions satisfy
		\begin{align*}
			-\frac{\|r\|_{R}}{\lambda^2 + 1} \leq r(\lambda) \leq \frac{\|r\|_{R}}{\lambda^2 + 1} 
		\end{align*}
		for any $\lambda \in \R$, so $\left|\langle \varphi, r \rangle_{L}\right| \leq \Im(\varphi(i)) \|r\|_{R}$.
	\end{proof}

	Now, in order to finish the proof, it suffices to check that $\lim_{z \to w}\|r_{z, w}\|_{R} = 0$. But this follows from
	\begin{align*}
		\|r_{z, w}\|_{R} = & |z - w| \sup_{\lambda \in \R}\left|\frac{\lambda^2 + 1}{(\lambda - z) (\lambda - w)}\right| \\
		= & |z - w| \sup_{\lambda \in \R}\left|\left(1 + \frac{z - i}{\lambda - z}\right) \left(1 + \frac{w + i}{\lambda - w}\right)\right| \\
		\leq & |z - w| \left(1 + \frac{|z - i|}{\Im(z)}\right) \left(1 + \frac{|w + i|}{\Im(w)}\right).
	\end{align*}
\end{proof}

Proving analyticity is not much harder.

\begin{lem}\label{weak_analytic}
	Let $\varphi \in \pickclass(\Hp)$. Then $\varphi$ is differentiable, and hence analytic.
\end{lem}
\begin{proof}
	Note that if we manage to show that the order $2$ divided differences of $\varphi$ are locally bounded, Theorem \ref{bounded_div} implies the claim. Strictly speaking we only proved Theorem \ref{bounded_div} on real line, but the proof would be almost identical in the complex case. Indeed: the essence of the proof was to observe that if the order $2$ divided differences are bounded, then the order $1$ divided differences are Lipschitz, and $\varphi$ is hence differentiable.

	Observe that for any $z_{0}, z_{1}, z_{2} \in \Hp$ we have
	\begin{align*}
		[z_{0}, z_{1}, z_{2}]_{\varphi} = \left\langle \varphi, \frac{1}{(\cdot - z_{0}) (\cdot - z_{1}) (\cdot - z_{2})}\right\rangle_{L}.
	\end{align*}
	Hence, by Lemma \ref{pick_norm_estimate} we can bound the divided difference just by estimating $\|(\cdot - z_{0})^{-1} (\cdot - z_{1})^{-1} (\cdot - z_{2})^{-1}\|_{R}$. But this is straighforward: one has, for instance,
	\begin{align*}
		\left\|\frac{1}{(\cdot - z_{0}) (\cdot - z_{1}) (\cdot - z_{2})}\right\|_{R} \leq \frac{1}{\Im(z_{0})} \left(1 + \frac{|z_{1} - i|}{\Im(z_{1})}\right) \left(1 + \frac{|z_{2} + i|}{\Im(z_{2})}\right).
	\end{align*}
\end{proof}

\begin{kor}\label{pick_predual_ans}
	$\pickclass$ is the dual cone of $R_{+}(\Hp \cup \Hm)$ in the sense of $\langle \cdot, \cdot \rangle_{L}$. In other words $\pickclass(\Hp) = \pickclass$.
\end{kor}

Note that the inequalities of proof of Lemma \ref{weak_analytic} can be easily extended to higher order divided differences.

\begin{prop}\label{pick_div_dif_estimate}
	Let $\varphi \in \pickclass(\Hp)$. Then for every compact $K \subset \Hp \cup \Hm$ there exists a constant $C(\varphi, K)$ such that
	\begin{align*}
		\left|[z_{0}, z_{1}, \ldots, z_{k}]_{\varphi}\right| \leq \frac{C(\varphi, K)}{\Im(z_{0}) \Im(z_{1}) \cdots \Im(z_{k})}
	\end{align*}
	for any $k \geq 1$ and $z_{0}, z_{1}, \ldots, z_{k} \in K$.
\end{prop}

\subsection{Functional extensions}

Let us give alternate, more functional analytic argument for Lemma \ref{weak_analytic}.

Recall that for any $\varphi \in \pickclass(\Hp)$ and $z, w \in \Hp$ we have
\begin{align*}
	[z, w]_{\varphi} = \left\langle \varphi, \frac{1}{(\cdot - z) (\cdot - w)} \right\rangle_{L}.
\end{align*}
As $z \to w$, by \ref{weak_analytic} the left-hand side converges to $\varphi'(w)$. This motivates us to define
\begin{align*}
	\left\langle \varphi, \frac{1}{(\cdot - w)^{2}} \right\rangle_{L} := \varphi'(w).
\end{align*}
More generally, it would make sense to set
\begin{align}\label{extension_formula}
	\left\langle \varphi, \frac{1}{(\cdot - w)^{k + 1}} \right\rangle_{L} := \frac{\varphi^{(k)}(w)}{k!},
\end{align}
for any $k \geq 1$, mimicking the Cauchy's integral formula for derivatives.

\begin{maar}
	Let $X \subset \C$. We will denote by $R^{\infty}(X)$ the $\C$-vector space of rational functions $r$ such that:
	\begin{itemize}
		\item $r$ vanishes at infinity.
		\item All poles of $r$ lie in $X$.
	\end{itemize}
	We will also write $R^{\infty}_{+}(X)/R^{\infty}_{\pm}(X)$ for the functions in $R^{\infty}(X)$, which are non-negative/real on $\R$.
\end{maar}

Note that we have simply extended a linear functional $\langle \varphi, \cdot\rangle_{L}$ to $R^{\infty}(\Hp \cup \Hm)$. Now: in what way is this extension really natural?

\begin{prop}\label{extension_positivity}
	Let $\varphi \in \pickclass(\Hp)$. Then
	\begin{align*}
		\langle \varphi, r\rangle_{L} \geq 0
	\end{align*}
	for any $r \in R_{+}^{\infty}(\Hp \cup \Hm)$.
\end{prop}

The reason for this is actually rather simple: we may approximate the elements of $R^{\infty}(\Hp \cup \Hm)$ by elements of $R(\Hp \cup \Hm)$.

\begin{lem}\label{rat_multiple_approx}
	Let $\varphi \in \pickclass(\Hp)$ and $r \in R^{\infty}(\Hp \cup \Hm)/R^{\infty}_{\pm}(\Hp \cup \Hm)/R^{\infty}_{+}(\Hp \cup \Hm)$. Then for any $\varepsilon > 0$ there exists $s \in R(\Hp \cup \Hm)/R_{\pm}(\Hp \cup \Hm)/R_{+}(\Hp \cup \Hm)$ such that
	\begin{align}\label{rat_approx}
		\|r - s&\|_{R} < \varepsilon \nonumber\\
		&\text{and } \\
		|\langle \varphi, r\rangle_{L} -  &\langle \varphi, s\rangle_{L}| < \varepsilon \nonumber
	\end{align}
\end{lem}
\begin{proof}
	Let us first take care of the case $r \in R^{\infty}(\Hp \cup \Hm)$. Note that is suffices to verify the claim for the functions of the form $(\cdot - w)^{-k - 1}$, where $w \in \Hp$ and $k \geq 0$. We proceed by induction on $k$.

	The case $k = 0$ is clear, so fix $k > 0$ and $w \in \Hp$. By the definition of the extension of $\langle \varphi, \cdot\rangle_{L}$ we have
	\begin{align*}
		\lim_{z \to w}\left(\frac{1}{z - w} \left(\left\langle \varphi, \frac{1}{(\cdot - z)^{k}}\right\rangle_{L} - \left\langle \varphi, \frac{1}{(\cdot - w)^{k}}\right\rangle_{L}\right)\right) = k \left\langle \varphi, \frac{1}{(\cdot - w)^{k + 1}}\right\rangle_{L}.
	\end{align*}
	If we manage to prove that
	\begin{align}\label{derivative_derivative}
		\lim_{w \to z} \left\| \frac{1}{z - w}\left(\frac{1}{(\cdot - z)^{k}} - \frac{1}{(\cdot - w)^{k}}\right) - \frac{k}{(\cdot - w)^{k + 1}}\right\|_{R} = 0,
	\end{align}
	we are done. Indeed: we have then found for $(\cdot - w)^{-k - 1}$ an approximation (in the sense of \ref{rat_approx}) by a rational function with poles of lower order, and by induction hypothesis this lower order approximation has approximation with simple poles, as desired.

	For \ref{derivative_derivative} one can simply note that
	\begin{align*}
		& \left\| \frac{1}{z - w}\left(\frac{1}{(\cdot - z)^{k}} - \frac{1}{(\cdot - w)^{k}}\right) - \frac{k}{(\cdot - w)^{k + 1}}\right\|_{R} \\
		\leq & \sum_{i = 1}^{k} \left\|\frac{1}{(\cdot - z)^{i} (\cdot - w)^{k + 1 - i}} - \frac{1}{(\cdot - w)^{k + 1}}\right\|_{R} \\
		\leq & \sum_{i = 1}^{k} \frac{1}{\Im(w)^{k + 1 - i}}\left\|\frac{1}{(\cdot - z)^{i}} - \frac{1}{(\cdot - w)^{i}}\right\|_{R} \\
		\leq & |z - w|\sum_{i = 1}^{k} \frac{1}{\Im(w)^{k + 1 - i}} \sum_{j = 1}^{i} \left\|\frac{1}{(\cdot - z)^{j} (\cdot - w)^{i + 1 - j}}\right\|_{R} \\
		\leq & |z - w| \left\|\frac{1}{(\cdot - z)(\cdot - w)}\right\|_{R}\sum_{i = 1}^{k} \frac{1}{\Im(w)^{k + 1 - i}} \sum_{j = 1}^{i} \frac{1}{\Im(z)^{j - 1} \Im(w)^{i - j}} \\
		= & O(|z - w|)
	\end{align*}
	for $z, w$ in any compact $K \subset \Hp$.

	If $r \in R^{\infty}_{\pm}(\Hp \cup \Hm)$, then our approximation satisfies $s \in R_{\pm}(\Hp \cup \Hm)$.

	Finally, consider the case $r \in R^{\infty}_{+}(\Hp \cup \Hm)$. Choose first $s \in R_{\pm}(\Hp \cup \Hm)$ with \ref{rat_approx}. Note that
	\begin{align*}
		s \geq r - \frac{\varepsilon}{(\cdot)^2 + 1} \geq -\frac{\varepsilon}{(\cdot)^2 + 1}
	\end{align*}
	so $s + \varepsilon ((\cdot)^2 + 1)^{-1} \in R_{+}(\Hp \cup \Hm)$ satisfies
	\begin{align*}
		\|r - s&\|_{R} < 2\varepsilon \nonumber\\
		&\text{and } \\
		|\langle \varphi, r\rangle_{L} -  \langle \varphi, s\rangle_{L}|& < \varepsilon (1 + \Im(\varphi(i)))
	\end{align*}
\end{proof}

\begin{proof}[Proof of Proposition \ref{extension_positivity}]
	t.f.i.f. Lemma \ref{rat_multiple_approx}.
\end{proof}

The point of all of this is that these arguments can be in a way ``reversed".

\begin{proof}[Alternate proof for Lemma \ref{weak_analytic}]
	We are going to extend $\langle \varphi, \cdot\rangle_{L}$ to a positive linear functional on $R^{\infty}(\Hp \cup \Hm)$. To this end fix any $r \in R^{\infty}(\Hp \cup \Hm)/R^{\infty}_{\pm}(\Hp \cup \Hm)/R^{\infty}_{+}(\Hp \cup \Hm)$ and cook up a sequence $(s_{k})_{k = 1}^{\infty}$ of elements in $R(\Hp \cup \Hm)/R_{\pm}(\Hp \cup \Hm)/R_{+}(\Hp \cup \Hm)$ with $\|r - s_{k}\| < \frac{1}{k}$ (with Lemma \ref{rat_multiple_approx}). As $\langle \varphi, \cdot\rangle_{L}$ is Lipschitz by \ref{pick_norm_estimate}, the sequence $(\langle \varphi, s_{k} \rangle_{L})_{k = 1}^{\infty}$ converges, and by setting
	\begin{align*}
		\langle \varphi, r\rangle_{L} = \lim_{k \to \infty} \langle \varphi, s_{k}\rangle_{L}
	\end{align*}
	we obtain such positive extension. Lemma \ref{pick_norm_estimate} (which definitely holds also for the extension) and \ref{derivative_derivative} imply that $\varphi$ is smooth and satisfies \ref{extension_formula}. Proposition \ref{pick_div_dif_estimate} implies that $\varphi$ satisfies the conditions of Theorem \ref{div_anal}, and is hence analytic.
\end{proof}

\section{Pick-Nevanlinna interpolation theorem}

Corollary \ref{pick_predual_ans} motivates the following definition.

\begin{maar}
	Let $X \subset \Hp$. We say that $\varphi \in \C^{X \cup X^{*}}$ is \text{weakly Pick} (on $X$) if for any $r \in R_{+}(X \cup X^{*})$ we have
	\begin{align*}
		\langle \varphi, r\rangle_{L} \geq 0.
	\end{align*}
	We denote the set of weakly pick functions on $X$ by $\pickclass(X \cup X^{*})$.
\end{maar}

All of the arguments of the section \ref{step_2} extend almost verbatim for sets $\pickclass(X \cup X^{*})$:
\begin{enumerate}[(i)]
	\item Any weakly Pick function on $X$ has translate that satisfies $\varphi(\overline{z}) = \overline{\varphi(z)}$ for any $z \in X$. We will again denote such translates by $\pickclass(X)$.
	\item If $\varphi \in \pickclass(X)$, then $\Im(\varphi(z)) \geq 0$ for any $z \in X$.
	\item If $\varphi \in \pickclass(X)$, then $\varphi$ is locally Lipschitz and analytic on every interior point of $X$.
\end{enumerate}

There's a slight problem with part (iii) though. We used Lemma \ref{pick_norm_estimate} in its proof. Proof of Lemma \ref{pick_norm_estimate} made use of the inequality
\begin{align*}
	\left|\langle \varphi, r \rangle_{L}\right| \leq \Im(\varphi(i)) \|r\|_{R},
\end{align*}
which doesn't make sense if $i \notin X$. But this problem is easy to fix: if $z_{0} \in X$, we may instead use
\begin{align*}
	\|r\|_{R, z_{0}} = \sup_{\lambda \in \R} |r(\lambda)| |\lambda - z_{0}|^2,
\end{align*}
as the  ``norm" and everything works as expected: the ``norms" $\|\cdot\|_{R, z_{0}}$ are all equivalent, as one checks easily enough.

It turns out that all weakly Pick functions arise from Pick functions.

\begin{lause}[Pick--Nevanlinna interpolation theorem]\label{pick_interpolation}
	Let $X \subset \Hp$. Then for any $\varphi \in \pickclass(X)$ there exists a Pick function $\tilde{\varphi}$ such that $\restr{\tilde{\varphi}}{X} = \varphi$.
\end{lause}

\begin{proof}
	In terms of linear functionals our task is: given linear functional on $R(X \cup X^{*})$, positive on $R_{+}(X \cup X^{*})$, we should extend the functional to $R(\Hp \cup \Hm)$ such that the extension is positive on $R_{+}(\Hp \cup \Hm)$. By Corollary \ref{pick_predual_ans} the extension is a Pick function.

	It is easy to see that such extension is not unique in general. However, if it so happens that $R(X \cup X^{*})$ is dense in $R(\Hp \cup \Hm)$ with respect to $\|\cdot\|_{R}$, the argument of the alternate proof for Lemma \ref{weak_analytic} gives unique positive extenion. This already covers large variety of sets $X$.
	\begin{lem}\label{pick_dual_dense}
		If $X \subset \Hp$ has an accumulation point in $\Hp$, then $R(X)$ is dense in $R(\Hp)$.
	\end{lem}
	\begin{proof}
		Take a sequence of distinct points $z_{0}, z_{1}, \ldots$ in $X$ converging to $z_{\infty} \in \Hp$. We may assume w.l.o.g. that $z_{\infty} = i$. By Newton expansion, for any $w \in \Hp$
		\begin{align*}
			\frac{1}{\lambda - w} - \sum_{i = 0}^{n} \frac{(w - z_{0}) \cdots (w - z_{i - 1})}{(\lambda - z_{0}) \cdots (\lambda - z_{i - 1}) (\lambda - z_{i})} = \frac{(w - z_{0}) \cdots (w - z_{n})}{(\lambda - w)(\lambda - z_{0}) \cdots (\lambda - z_{n})}.
		\end{align*}
		If $|w - i| < 1$, norm of the error term tends to zero. It follows that $R(X)$ is dense in $R(X \cup \D(i, 1))$. But as $2 i$ is an accumulation point of $X \cup \D(i, 1)$, we may repeat the previous argument: $R(X)$ is dense in $R(X \cup \D(2 i, 2))$. Bootstrapping along the sequence $(2^{n} i)_{n = 1}^{\infty}$ yields the claim.
	\end{proof}

	For the general case one has to work slighty harder. Observe first that one only needs to prove the following lemma.
	\begin{lem}\label{pick_one_point_extension}
		Fix $X \in \Hp$ and $w \in \Hp \setminus X$. Then any element of $\pickclass(X)$ can be extended to an element of $\pickclass(X \cup \{w\})$.
	\end{lem}
	Given this lemma, one can, for instance, use transfinite induction (or Zorn's lemma if one so prefers) to extend any element of $\pickclass(X)$ to $\pickclass(\Hp)$. Or one may inductively extend $X$ by a countable set with an accumulation point, after which there exists a unique extension by the already proven dense case.

	\begin{proof}[Proof of Lemma \ref{pick_one_point_extension}]
		Write $r_{w}(\lambda) = (\lambda - w)^{-1}$. By Proposition \ref{pick_functional_span} $r \in R_{+}(X \cup X^{*} \cup \{w, \overline{w}\})$ is of the form
		\begin{align*}
			ar_{w} + (ar_{w})^{*} + r,
		\end{align*}
		where $a \in \C$ and $r \in R_{\pm}(X \cup X^{*})$: encode such rational functions as a set $\mathcal{F} \subset \C \times R_{\pm}(X \cup X^{*})$. Now, the extension should satisfy
		\begin{align}\label{pick_extension_ineq}
			\langle \varphi, ar_{w} + (ar_{w})^{*} + r \rangle_{L} = 2 \Re(a \langle \varphi, r_{w} \rangle_{L}) + \langle \varphi, r\rangle_{L} \geq 0
		\end{align}
		for $(a, r) \in \mathcal{F}$. Note that if we find a value $\langle \varphi, r_{w} \rangle_{L}$ which satisfies all such inequalities, it determines the desired extension.

		Each of the inequalities of the form \ref{pick_extension_ineq} (where $a \neq 0$) force $\langle \varphi, r_{w} \rangle_{L}$ in some closed half-space of $\C$. It is easy to check that for any $a \in \C$ there exist $(a, r) \in \mathcal{F}$: $\langle \varphi, r_{w} \rangle_{L}$ is constrained by half-spaces of all directions. This implies that set of suitable $\langle \varphi, r_{w} \rangle_{L}$'s can be expressed as intersection of compact sets, certain finite intersections of half-spaces in $\mathcal{F}$. We hence just have to verify that all such finite intersections are non-empty.

		This, finally, follows almost immediately from the Farkas' lemma.
		\begin{lem}[Farkas' lemma]\label{farkas_lemma}
			Let $n, m \geq 1$, $(V, \langle \cdot, \cdot \rangle)$ $n$-dimensional inner product space over $\R$, $v_{1}, v_{2}, \ldots, v_{m} \in V$ and $c_{1}, c_{2}, \ldots, c_{m} \in \R$. Assume that whenever $t_{1}, t_{2}, \ldots, t_{m} \geq 0$ are such that
			\begin{align*}
				t_{1} v_{1} + t_{2} v_{2} + \ldots + t_{m} v_{m} = 0,
			\end{align*}
			then also
			\begin{align*}
				t_{1} c_{1} + t_{2} c_{2} + \ldots + t_{m} c_{m} \geq 0.
			\end{align*}
			Then there exists $u \in V$ such that $\langle v_{i}, u\rangle + c_{i} \geq 0$ for any $1 \leq i \leq m$.
		\end{lem}
		Indeed: the inequalities in \ref{pick_extension_ineq} can be interpreted in the sense of Farkas' lemma, where $V := \C$ is two-dimensional inner product space over $\R$ with $\langle z, w \rangle_{\C} = \Re(z \overline{w})$ as the inner product. To check the condition of the lemma, pick any finite set of pairs $(a_{1}, r_{1}), (a_{2}, r_{2}), \ldots, (a_{m}, r_{m}) \in \mathcal{F}$. Take also $t_{1}, t_{2}, \ldots, t_{m} \geq 0$ with $\sum_{i = 1}^{m} t_{i} a_{i} = 0$. Now
		\begin{align*}
			0 \leq \sum_{i = 1}^{m} t_{i} \left(ar_{w} + (ar_{w})^{*} + r_{i}\right) = \left(\sum_{i = 1}^{m} t_{i} a_{i} r_{w}\right) + \left(\sum_{i = 1}^{m} (t_{i} a_{i} r_{w})^{*}\right) + \sum_{i = 1}^{m} t_{i} r_{i} = \sum_{i = 1}^{m} t_{i} r_{i}
		\end{align*}
		pointwise, and hence $\sum_{i = 1}^{m} t_{i} \langle \varphi, r_{i} \rangle_{L} \geq 0$. By Farkas' lemma we can find $\langle \varphi, r_{w} \rangle_{L} \in \C$ such that
		\begin{align*}
			2 \Re(a_{i} \langle \varphi, r_{w} \rangle_{L}) + \langle \varphi, r_{i} \rangle_{L} \geq 0
		\end{align*}
		for any $1 \leq i \leq m$. This is exactly what we wanted.
	\end{proof}
\end{proof}

For completeness, we also prove Farkas' lemma.

\begin{proof}[Proof of Lemma \ref{farkas_lemma}]
	Proof is by induction on $n$.

	Case $n = 1$: We may clearly ignore all the zeros from the $v_{i}$'s. If all $v_{i}$'s are positive or negative, claim is trivial. Assume then that there are both positive and negative $v_{i}$'s. We may scale $v_{i}$'s (with $c_{i}$'s) such that they are all $1$ or $-1$: w.l.o.g. first $k$ $v_{i}$'s are ones. We should prove that one may choose $u$ such that $u + c_{i} \geq 0$ for any $1 \leq i \leq k$ and $-u + c_{j} \geq 0$ for any $k + 1 \leq j \leq m$. This is clearly possible if $c_{i} + c_{j} \geq 0$ for any $1 \leq i \leq k < j \leq m$. But if one sets $t_{i} = 1$ and $t_{j} = 1$ and other $t_{l}$'s to zero in the main condition, this is exactly the inequality one gets.

	Induction step: We split into two cases.
	\begin{itemize}
		\item Case 1: There exists $t_{1}, t_{2}, \ldots, t_{m} \geq 0$, not all zero, such that $\sum_{i = 1}^{m} t_{i} v_{i} = 0$.
		\item Case 2: The complement of case 1.
	\end{itemize}
	Let us also denote
	\begin{align*}
		C = \cone \{v_{i} | 1 \leq i \leq m\}.
	\end{align*}
	\textbf{Case} 1: It follows that there exist nonzero $w \in V$ such that $w, -w \in C$. Decompose $V = \vspan(w) \oplus W$, $v_{i} = v_{i}^{(w)} + v_{i}^{W}$ and $u = u^{(w)} + u^{W}$. The idea is to interpret the problem of finding $u$ as parametrized problem of finding $u^{W}$. We should find $u^{(w)}$ such that the following condition holds: whenever $t_{1}, t_{2}, \ldots, t_{m} \geq 0$ are such that
	\begin{align*}
		\sum_{i = 1}^{m} t_{i} v_{i}^{W} = 0
	\end{align*}
	then
	\begin{align*}
		0 \leq \sum_{i = 1}^{m} t_{i} (c_{i} + v_{i}^{(w)} u^{(w)}) = \sum_{i = 1}^{m} t_{i} c_{i} + u^{(w)}\sum_{i = 1}^{m} t_{i} v_{i}^{(w)}.
	\end{align*}
	Then, by $n - 1$ dimensional case on $W$, there exists $u^{W}$ such that
	\begin{align*}
		0 \leq c_{i} + v_{i}^{(w)} u^{(w)} + \langle v_{i}^{W}, u^{W} \rangle = \langle v_{i}, u \rangle + c_{i}.
	\end{align*}
	for any $1 \leq i \leq m$. This can be interpreted as one-dimensional problem where $v_{i}$'s are sums $\sum_{i = 1}^{m} t_{i} v_{i}^{(w)}$ and $c_{i}$'s sums $\sum_{i = 1}^{m} t_{i} c_{i}$ where $t_{i}$'s range over all tuples of non-negative numbers with $\sum_{i = 1}^{m} t_{i} v_{i}^{W} = 0$. But now there are infinitely many conditions so we can't immediately use the case $n = 1$. However, by the extra assumption $w, -w \in C$, so one can find $t_{i}$'s such that $\sum_{i = 1}^{m} t_{i} v_{i}^{W} = 0$ and $\sum_{i = 1}^{m} t_{i} v_{i}^{(w)}$ is both positive and negative. This means that the set of suitable $u^{(w)}$'s is intersection of bounded closed intervals so, as in the case $n = 1$, it suffices to consider only pairs of conditions. So take $s_{1}, s_{2} \geq 0$ and $t_{i, 1}, t_{i, 2} \geq 0$ for $1 \leq i \leq m$ such that $\sum_{i = 1}^{m} t_{i, 1} v_{i}^{W} = \sum_{i = 1}^{m} t_{i, 2} v_{i}^{W} = 0$ and
	\begin{align*}
		s_{1} \sum_{i = 1}^{m} t_{i, 1} v_{i}^{(w)} + s_{2} \sum_{i = 1}^{m} t_{i, 2} v_{i}^{(w)} = 0.
	\end{align*}
	Then $\sum_{i = 1}^{m} \left(s_{1} t_{i, 1} + s_{2} t_{i, 2} \right) v_{i} = 0$ so by the main condition
	\begin{align*}
		0 \leq \sum_{i = 1}^{m} \left(s_{1} t_{i, 1} + s_{2} t_{i, 2} \right) c_{i} = s_{1} \sum_{i = 1}^{m} t_{i, 1} c_{i} + s_{2}\sum_{i = 1}^{m} t_{i, 2} c_{i},
	\end{align*}
	as desired.

	\textbf{Case} 2: We first claim that there exists $w \in V$ such that $w, -w \notin C$. Assuming otherwise, take $1 \leq j < l \leq m$ (the case $m = 1$ is clear as $n > 1$). Now as $v_{j} - v_{l} \in C$ or $v_{l} - v_{j} \in C$, w.l.o.g. $v_{j} = v_{l} + \sum_{i = 1}^{m} t_{i} v_{i}$ for some $t_{1}, \ldots, t_{m} \geq 0$. If $t_{j} \geq 1$, we have found non-trivial decomposition for $0$, a contradiction. If on the other hand $t_{j} < 1$, we see that $v_{j} \in \cone\{a_{v} | i \neq j\}$, so we may forget $v_{j}$. Inducting on $m$ finishes the claim.

	Again, decompose $V = \vspan(w) \oplus W$, $v_{i} = v_{i}^{(w)} + v_{i}^{W}$ and $u = u^{(w)} + u^{W}$. We prove that we may set $u^{(w)} = 0$ and also the reduced problem in $W$ falls in the case 2. Indeed, if $t_{1}, t_{2}, \ldots, t_{m} \geq 0$ are such that $\sum_{i = 1}^{m} t_{i} v_{i}^{W} = 0$ then $\sum_{i = 1}^{m} t_{i} v_{i}^{(w)} \in C \cap \vspan(w) = \{0\}$. Consequently $\sum_{i = 1}^{m} t_{i} v_{i} = 0$ and hence $t_{i} = 0$ for any $1 \leq i \leq m$.
\end{proof}

\begin{huom}\label{taylor_section_rem}
	Pick--Nevanlinna interpolation theorem can be extended in many ways. One such extension concerns Taylor sections.
	\begin{lause}\label{pick_taylor_sections}
		Fix $d : \Hp \to \N \cup \{\infty\}$ and numbers $c_{z, k} \in \C$ for any $z \in \Hp$ and $0 \leq k \leq d(z) - 1$. Then there exists Pick function $\varphi$ with
		\begin{align*}
			\frac{\varphi^{(k)}(z)}{k!} = c_{z, k},
		\end{align*}
		if and only if the functional with
		\begin{align*}
			\langle \varphi, (\cdot - z)^{-k - 1}\rangle_{L} = c_{z, k},
		\end{align*}
		is positive.
	\end{lause}
	Here the definition of $\langle \varphi, \cdot\rangle_{L}$ is completed exactly how one would expect. Theorem \ref{pick_taylor_sections} could be proven with pretty much same ideas as Theorem \ref{pick_interpolation}; we're not going to do that, however.
\end{huom}

\section{Notes and references}

Pick functions and representation theorem \ref{pick_nevanlinna_herglotz_representation_theorem} are discussed in numerous sources; see for example (?). Pick--Nevanlinna interpolation theorem \ref{pick_interpolation} was first observed and proved independently by Pick \cite{Pick} and Nevanlinna \cite{Nevan}. Since then, many different approaches exist, see (?) for a survey. Usually the treatment builds on the notion of Pick matrix: given $\varphi : \Hp \to \C$ and $z_{1}, z_{2}, \ldots, z_{n} \in \Hp$ one may define a matrix
\begin{align*}
	\begin{bmatrix}
		[z_{1}, \overline{z_{1}}]_{\varphi} & [z_{1}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{1}, \overline{z_{n}}]_{\varphi} \\
		[z_{2}, \overline{z_{1}}]_{\varphi} & [z_{2}, \overline{z_{2}}]_{\varphi} & \cdots & [z_{2}, \overline{z_{n}}]_{\varphi} \\
		\vdots & \vdots & \ddots & \vdots \\
		[z_{n}, \overline{z_{1}}]_{\varphi} & [z_{n}, \overline{z_{2}}]_{\varphi} & \cdots &  [z_{n}, \overline{z_{n}}]_{\varphi}
	\end{bmatrix}.
\end{align*}
One may check that quadratic functionals of such matrices are just Pick functionals in disguise. Consequently: $\varphi$ is a Pick function, if and only if all such matrices are positive.

Lemma \ref{pick_dual_dense} is not best possible. It can be shown that for $X \in \Hp$, $R(X)$ is dense in $R(\Hp)$, if and only if
\begin{align*}
	\sum_{z \in X} \frac{\Im(z)}{|z|^2 + 1} = \infty.
\end{align*}
It can be also shown that if $R(X)$ is not dense in $R(\Hp)$, then there exists weakly Pick function on $X$ with two different Pick extensions.

Approach taken in this text is similar to (?).
\begin{comment}

TODO:
\begin{itemize}
	\item Examples of representing measures behind functions and functions behind representing measures
	\item Spectral commutant lifting theorem
	\item Use Morera's theorem to prove weak Hindmarsh's theorem
	\item Nice formula for finite Pick extension (rational function case)
\end{itemize}

\end{comment}






