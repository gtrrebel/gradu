\chapter{Matrix monotone functions -- part 3}

\section{Loewner's theorem}

Aim of this chapter is to prove theorem \ref{weak_loewner}. The proof is in several steps. First, ``if"-direction is the easy part.

\begin{lem}\label{weak_loewner_converse}
	Let $f$ be a Pick function, which analytically extends to $(\C \setminus \R) \cup (a, b)$. Assume further that $\restr{f}{(a, b)}$ is real. Then $\restr{f}{(a, b)} \in P_{\infty}(a, b)$.
\end{lem}
\begin{proof}
	Since $\restr{f}{(a, b)}$ is smooth, it suffices to prove that for any $n \geq 1$ and $q \in \C_{n - 1}[x]$ the $(2n - 1)$'th derivative of $f N(q)$ is non-negative. But as $f$ is a Pick function, we have for any $t \in (a, b)$
	\begin{align*}
		\frac{1}{(2 n - 1)!} \frac{d^{2 n - 1}(f(t) N(q)(t))}{d t^{2 n - 1}} = \lim_{\atop{z_{1}, \ldots, z_{n} \in \Hp}{z_{1}, \ldots, z_{n} \to t}} [z_{1}, \overline{z_{1}}, \ldots, z_{n}, \overline{z_{n}}]_{f N(q)} \geq 0.
	\end{align*}
\end{proof}

The ``only if" is the tricky part. Our plan is the following:
\begin{enumerate}
	\item First show that $f$ is real analytic on $(a, b)$.
	\item Next, show that if we can extend $f$ analytically to $\D(x_{0}, r)$ for some $x_{0} \in (a, b)$ and $r > 0$, then the extension is weakly Pick on $\D(x_{0}, r) \cap \Hp$.
	\item Finally, by theorem \ref{open_pick_interpolation} we get Pick function, which agree with $f$ on $(x_{0} - r, x_{0} + r)$, so by real analyticity of $f$, on the whole interval $(a, b)$.
\end{enumerate}

\begin{lem}\label{loewner_analytic}
	Let $f \in P_{\infty}(a, b)$. Then $f$ is real analytic.
\end{lem}
\begin{proof}
	Proof is almost the same as that of theorem \ref{Hindmarsh_theorem}. In the class $P_{\infty}(a, b)$ we have
	\begin{align*}
		[x_{0}, x_{1}, \ldots, x_{n}]_{f} \leq \frac{1}{\dist(x_{2}, \R \setminus (a, b)) \cdots \dist(x_{2}, \R \setminus (a, b))} [x_{0}, x_{1}]_{f}
	\end{align*}
	for any $a < x_{0}, x_{1}, \ldots, x_{n} < b$. As the first divided differences are locally bounded, conditions of the theorem \ref{div_anal} are satisfied.
\end{proof}

\begin{lem}\label{loewner_extension}
	Assume that $f \in P_{\infty}(a, b)$, $f$ is analytic at $x_{0} \in (a, b)$ such that it can analytically extended to $\D(x_{0}, r)$ for some $r > 0$. Then the extension is weakly Pick on $\D(x_{0}, r) \cap \Hp$.
\end{lem}
\begin{proof}
	Again, proof is almost the same as that of theorem \ref{open_pick_lemma}: now just choose the sequence $z_{1}, z_{2}, \ldots$ on $(a, b)$ and do estimates on $\R \setminus (a, b)$.
\end{proof}

\begin{proof}[Proof of theorem \ref{weak_loewner}]
	This follows immediately from \ref{weak_loewner_converse}, \ref{loewner_analytic}, \ref{loewner_extension} and \ref{open_pick_interpolation}.
\end{proof}

\section{Notes and references}

\begin{comment}

TODO:

\begin{itemize}
	\item Why smoothness
	\item Examples
	\item Pick functions are monotone
	\item Heaviside function
	\item Trace inequalities: if $f$ is monotone/convex then $\tr f$ is monotone/convex. Proof idea: we may write $\tr f$ as a limit of finite sum of translations of Heaviside functions (monotone case) or absolute values (convex case), so its sufficient to prove the claim for these functions. For monotone case it hence suffices to prove that if $A \leq B$, $B$ has at least as many non-negative eigenvalues as $A$. But this is clear by subspace characterization of non-negative eigenvalues. For convex case, it suffices to prove that $\tr |A| + \tr |B| \geq \tr |A + B|$ for any $A, B \in \H^{n}(a, b)$. For this, note that if $(e_{i})_{i = 1}^{n}$ is eigenbasis of $A + B$, we have
	\begin{eqnarray*}
		\tr |A + B| &=& \sum_{i = 1}^{n} \langle |A + B| e_{i}, e_{i} \rangle \\
		= \sum_{i = 1}^{n} \left|\langle (A + B) e_{i}, e_{i} \rangle \right| &\leq& \sum_{i = 1}^{n} \left|\langle A e_{i}, e_{i} \rangle \right| + \sum_{i = 1}^{n} \left|\langle B e_{i}, e_{i} \rangle \right| \\
		\leq \sum_{i = 1}^{n} \langle |A| e_{i}, e_{i} \rangle + \sum_{i = 1}^{n} \langle |B| e_{i}, e_{i} \rangle &=& \tr |A| + \tr |B|
	\end{eqnarray*}
	\item What about trace inequalities for $k$-tone functions? Eigen-package seems to find a counterexample for $6$-tone functions and $n = 2$, but it's hard to see if there's enough numerical stability. At divided differences of polynomials vanish. First non-trivial question would be:
	If $A_{j} = A + j H$ for $0 \leq j \leq 3$ and $H \geq 0$. Then is it necessarily the case that
	\[
		\tr \left(A_{3} |A_{3}| - 3 A_{2}|A_{2}| + 3 A_{1} |A_{1}| - A_{0} |A_{0}| \right) \geq 0?
	\]
	This would imply that $3$-tone functions would lift to trace $3$-tone functions. Maybe expressing this as a contour integral from $-i \infty \to i \infty$ a same tricks as in the paper. First projection case: $H$ is projection. Or: approximate by integrals of heat kernels. It should be sufficient to proof things for $k$-fold integrals or heat kernel, or by scaling just for gaussian function.
	\item How is the previous related to the $|\cdot|$ not being operator-convex: quadratic form inequality for eigenvectors is not enough.
	\item The previous also implies that
	\[
		f(Q_{A}(v)) \leq Q_{f(A)}(v)
	\]
	for any convex $f$. Using this and Minkowski one sees that $p$-schatten norms are indeed norms.
	\item For $f, g$ generalization (Look at $h(X) = g (\tr f(X))$) we need that $f$ is convex. What else? $h$ is convex if it is convex for diagonalizable matrices and $f$ is convex and $g$ increasing. For the diagonalizable maps it is sufficient that $f$ is increasing and $g = f^{-1}$ and $\log \circ f \circ \exp$ is convex.
	\item Von Neumann trace inequality, more trace inequalities.
	\item On Generalizations of Minkowski's Inequality in the Form of a Triangle Inequality, Mulholland
	\item There should nice proof for Loewner theorem, like the blog post for Bernstein's big theorem.
\end{itemize}

\end{comment}
